<?xml version="1.0" encoding="UTF-8"?>
<!--
  ~ Copyright (c) 2011. Purple Door Systems, BV.
  -->

<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:c="http://www.springframework.org/schema/c"
       xmlns:util="http://www.springframework.org/schema/util"
       xmlns:task="http://www.springframework.org/schema/task"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="
       http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
       http://www.springframework.org/schema/task
       http://www.springframework.org/schema/task/spring-task-3.1.xsd
       http://www.springframework.org/schema/util
       http://www.springframework.org/schema/util/spring-util-3.1.xsd">

    <!-- At startup, remove old job status and log entries and mark running job entries as finished -->
    <bean class="com.lela.commons.jobs.JobLogCleanup" c:ingestJobService-ref="ingestJobService"/>

    <bean id="jobDetailEventService" class="com.lela.commons.service.impl.JobDetailEventServiceImpl"
            c:alertEmailAddress="${jobDetail.monitor.email}" c:emailService-ref="emailService" c:environment="${environment}"/>

    <util:map id="ingestExecutors">
        <entry key="chain" value-ref="chainJobExecutor"/>
        <entry key="etl" value-ref="etlJobExecutor"/>
        <entry key="java" value-ref="javaJobExecutor"/>
        <entry key="talend" value-ref="talendJobExecutor"/>
        <entry key="sync" value-ref="syncJobExecutor"/>
    </util:map>

    <bean id="distributedCacheEvictionService" class="com.lela.commons.service.impl.DistributedCacheEvictionServiceImpl">
        <!-- <constructor-arg ref="localCacheEvictionService"/> -->
        <constructor-arg ref="queueService"/>
        <constructor-arg ref="queue"/>
        <constructor-arg ref="queueObjectMapper"/>
    </bean>
    
    <bean id="etlDataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
        <property name="driverClassName" value="${etl.driverClassName}"/>
        <property name="url" value="${etl.url}"/>
        <property name="username" value="${etl.username}"/>
        <property name="password" value="${etl.password}"/>
        <property name="validationQuery" value="SELECT 1"/>
        <property name="testOnBorrow" value="true"/>
    </bean>

    <bean id="ingestObjectMapper" class="com.lela.util.utilities.jackson.CustomObjectMapper">
    </bean>

    <bean id="annotationValidator" class="org.springframework.validation.beanvalidation.LocalValidatorFactoryBean"/>
    <!--
        JOB SCHEDULING
    -->

    <!-- Pool size must be at least 2 for job chains to work -->
    <task:executor id="taskExecutor" pool-size="5"/>

    <!-- Note the scheduler is a custom class with a Sleep of 2 seconds to avoid Tomcat shutdown issues -->
    <bean id="ingestJobScheduler" class="org.springframework.scheduling.quartz.SchedulerFactoryBean" destroy-method="destroy">

        <property name="jobDetails">
            <list>
            </list>
        </property>
        <property name="triggers">
            <list>
                <!--
                <ref bean="dealEtlJobDetailTrigger" />
                <ref bean="storeEtlJobDetailTrigger" />
                <ref bean="babymonitorEtlJobDetailTrigger"/>
                <ref bean="branchEtlJobDetailTrigger" />
                <ref bean="categoryEtlJobDetailTrigger"/>
                <ref bean="functionalFilterEtlJobDetailTrigger"/>
                <ref bean="ownerEtlJobDetailTrigger"/>
                <ref bean="questionEtlJobDetailTrigger"/>
                <ref bean="cameraEtlJobDetailTrigger"/>
                <ref bean="carrierEtlJobDetailTrigger"/>
                <ref bean="carSeatEtlJobDetailTrigger"/>
                <ref bean="cribEtlJobDetailTrigger"/>
                <ref bean="highchairEtlJobDetailTrigger"/>
                <ref bean="strollerEtlJobDetailTrigger"/>
                <ref bean="postalCodeEtlJobDetailTrigger"/>
                -->
                <ref bean="facebookProfileTrigger"/>
                <ref bean="facebookMotivatorTrigger"/>
                <ref bean="facebookTaskTrigger"/>
                <ref bean="affiliateReportingTrigger"/>
                <ref bean="priceOfferTrigger"/>
                <ref bean="priceOfferLinkshareTrigger"/>
                <ref bean="nightlyMotivatorUpdatesTrigger"/>
            </list>
        </property>
        <property name="waitForJobsToCompleteOnShutdown" value="true"/>
        <property name="taskExecutor" ref="taskExecutor"/>
    </bean>

    <bean id="ingestJobService" class="com.lela.commons.service.impl.IngestJobServiceImpl"/>

    <!--
        JOB EXECUTION
    -->
    <bean id="etlJobExecutor" class="com.lela.commons.jobs.etl.EtlJobExecutor"
            c:jobs-ref="etlJobExecutorJobs" c:preExecutionQueries-ref="preExecutionQueries" c:conversionService-ref="conversionService"
            c:etlDataSource-ref="etlDataSource" c:ingestObjectMapper-ref="ingestObjectMapper" c:ingestJobService-ref="ingestJobService"
            c:ingestUser="${ingest.user}" c:ingestPassword="${ingest.password}"
            c:jsonTemplateEngine-ref="jsonTemplateEngine" c:scheduler-ref="ingestJobScheduler" c:userService-ref="userService">
    </bean>

    <util:list id="etlJobExecutorJobs">
        <!-- ETL Insert Jobs -->
        <ref bean="storeEtlJobDetail"/>
        <ref bean="dealEtlJobDetail"/>
        <!--<ref bean="babymonitorEtlJobDetail"/>-->
        <ref bean="branchEtlJobDetail"/>
        <ref bean="categoryEtlJobDetail"/>
        <ref bean="functionalFilterEtlJobDetail"/>
        <ref bean="ownerEtlJobDetail"/>
        <ref bean="questionEtlJobDetail"/>
        <!--
        <ref bean="cameraEtlJobDetail"/>
        <ref bean="carrierEtlJobDetail"/>
        <ref bean="carSeatEtlJobDetail"/>
        <ref bean="cribEtlJobDetail"/>
        <ref bean="highchairEtlJobDetail"/>
        <ref bean="strollerEtlJobDetail"/>
        -->
        <ref bean="postalCodeEtlJobDetail"/>
        <ref bean="navbarEtlJobDetail"/>
        <ref bean="affiliateReportingUserSalesEtlJobDetail"/>
        <ref bean="affiliateReportingAnonymousSalesEtlJobDetail"/>

        <!-- ETL Delete Jobs -->
        <ref bean="deleteItemsJobDetail"/>

        <!-- JSON Template Jobs !!! DEPRECATED IN FAVOR OF ITEM SYNC JOB !!! -->
        <!-- <ref bean="itemIngestJobDetail"/> -->
    </util:list>

    <!--
        SYNC JOB EXECUTION
    -->
    <bean id="syncJobExecutor" class="com.lela.commons.jobs.etl.SynchronizationJobExecutor"
            c:userService-ref="userService" c:conversionService-ref="conversionService"
            c:ingestJobService-ref="ingestJobService"
            c:etlDataSource-ref="etlDataSource" c:ingestObjectMapper-ref="ingestObjectMapper"
            c:ingestUser="${ingest.user}" c:ingestPassword="${ingest.password}"
            c:jsonTemplateEngine-ref="jsonTemplateEngine" c:mongoTemplate-ref="mongoTemplate"
            c:scheduler-ref="ingestJobScheduler"
            c:jobs-ref="syncJobExecutorJobs" c:preExecutionQueries-ref="preExecutionQueries">
    </bean>

    <util:list id="syncJobExecutorJobs">
        <ref bean="itemSyncJobDetailNew"/>
    </util:list>

    <util:list id="preExecutionQueries">
        <value>SET SESSION group_concat_max_len = 1000000</value>
        <value>SET SESSION tmp_table_size = 33554432</value>
        <value>SET SESSION max_heap_table_size = 33554432</value>
    </util:list>

    <bean id="deleteItemsJobDetail" class="com.lela.commons.jobs.etl.EtlJobDetail">
        <property name="name" value="Delete Items"/>
        <property name="sqlQuery">
            <value>
                <![CDATA[
                select rlnm from item_delete
                ]]>
            </value>
        </property>
        <property name="ingestService" ref="itemService"/>
        <property name="ingestMethod" value="removeItem"/>
        <property name="simpleType" value="java.lang.String"/>
        <property name="etlUpdateQuery">
            <value>
                <![CDATA[
                delete from item_delete where rlnm = '@{rlnm}'
                ]]>
            </value>
        </property>
    </bean>

    <bean id="itemSyncJobDetailNew" class="com.lela.commons.jobs.etl.SynchronizationJobDetail">
        <property name="name" value="EAV - Synchronize Items (ItemStatusId Flag)"/>
        <property name="groupName" value="EAV Jobs"/>
        <property name="preExecutionQueries">
            <list>
                <value>
                    <![CDATA[
                    call SetFlagsForIngest(${etl.ingest.includeUntested:0})
                    ]]>
                </value>
            </list>
        </property>
        <property name="interceptors">
            <list>
                <ref bean="functionalFiltersIngestJobInterceptor"/>
            </list>
        </property>
        <property name="sqlQuery">
            <value>
                <![CDATA[
				call QueryItems('${environment}', 1)
                ]]>
            </value>
        </property>
        <property name="dirtyProperty" value="isdirty"/>
        <property name="idProperty" value="rlnm"/>
        <property name="mongoQuery" value="{ 'ctgry.tld': { $in: [2,12,13,14,15,20,21,22,24,34,35,11,16,25,46,47,48,49,51,52,53,54,57,58,50,55,59,63,64,70]}  }"/>  <!-- IMPORTANT!!! THIS MUST BE THE SAME AS THE ETL QUERY -->
        <property name="mongoFields" value="{ rlnm: 1 }"/>
        <property name="mongoDto" value="com.lela.commons.jobs.etl.RlnmDto"/>
        <property name="upsert">
            <bean class="com.lela.commons.jobs.etl.ConvertAndSaveArgs">
                <property name="jsonTemplate" value="item.json"/>
                <property name="ingestService" ref="itemService"/>
                <property name="ingestMethod" value="saveItems"/>
                <property name="jsonType" value="com.lela.domain.document.Item"/>
                <property name="sorter">
                    <bean class="com.lela.commons.sort.ItemSorter" scope="prototype"/>
                </property>
                <property name="validator" ref="annotationValidator"/>
                <property name="etlUpdateQuery">
                    <value>
                        <![CDATA[
						call IngestUpdateStatus(@{tld}, '${environment}')
                        ]]>
                    </value>
                </property>
                <property name="ingestLogProperty" value="rlnm"/>
            </bean>
        </property>
        <property name="delete">
            <bean class="com.lela.commons.jobs.etl.ConvertAndSaveArgs">
                <property name="ingestService" ref="itemService"/>
                <property name="ingestMethod" value="removeItem"/>
                <property name="simpleType" value="java.lang.String"/>
                <property name="etlUpdateQuery">
                    <value>
                        <![CDATA[
			update item_changed ic, item i
			set ic.isdirty_${environment} = -1,
                            i.SiteStatusId = 3
			where i.UniqueItemId = ic.UniqueItemId and ic.UniqueItemId = @{tld}
                        
                        ]]>
                    </value>
                </property>
                <property name="ingestLogProperty" value="rlnm"/>
            </bean>
        </property>
        <property name="batchSize" value="10"/>
        <property name="threadPool" value="5"/>
    </bean>

    <!--
        NAVBAR INGEST JOB
    -->
    <bean id="navbarEtlJobDetailTrigger" class="org.springframework.scheduling.quartz.CronTriggerBean">
        <property name="jobDetail" ref="navbarEtlJobDetail"/>
        <property name="cronExpression" value="0 0 3 * * ?"/>
        <property name="misfireInstructionName" value="MISFIRE_INSTRUCTION_DO_NOTHING"/>
    </bean>

    <bean id="navbarEtlJobDetail" class="com.lela.commons.jobs.etl.EtlJobDetail">
        <property name="name" value="Ingest Navbar"/>
        <property name="sqlQuery">
            <value>
                <![CDATA[
				CALL IngestNavbar;
                ]]>
            </value>
        </property>
        <property name="ingestService" ref="navigationBarService"/>
        <property name="ingestMethod" value="saveNavigationBars"/>
        <property name="jsonType" value="com.lela.domain.document.NavigationBar"/>
        <property name="batchSize" value="10"/>
        <property name="etlUpdateQuery">
            <value>
                <![CDATA[
                update navbar set objectId = '@{id}', isdirty = -1 where navbarID = @{tld}
                ]]>
            </value>
        </property>
    </bean>
    <!--
        STORE INGEST JOB
    -->
    <bean id="storeEtlJobDetailTrigger" class="org.springframework.scheduling.quartz.CronTriggerBean">
        <property name="jobDetail" ref="storeEtlJobDetail"/>
        <property name="cronExpression" value="0 0 3 * * ?"/>
        <property name="misfireInstructionName" value="MISFIRE_INSTRUCTION_DO_NOTHING"/>
    </bean>

    <bean id="storeEtlJobDetail" class="com.lela.commons.jobs.etl.EtlJobDetail">
        <property name="name" value="Ingest Store"/>
        <property name="sqlQuery">
            <value>
                <![CDATA[
		SELECT 
			replace(concat('{"nm":"',
		       CASE
		       WHEN MerchantName = 'Amazon.com Books' THEN 'Amazon.com'
		       WHEN MerchantName = 'HP Home & Home Office Store' THEN 'HP'
		       WHEN MerchantName = 'Sony - Computers & Electronics' THEN 'Sony'
		       ELSE
			 MerchantName
		       END,
		       '",',
		       '"tld":"', ifnull(MerchantId, 'null'), '",',
		       '"rlnm":"', lower(replace(replace(replace(replace(replace(replace(MerchantName, '-', ''), '''', ''), '&', 'and'), ',', ''), '.', ''), ' ', '')), '",',
		       '"srlnm":', ifnull(concat('"', LelaURL, '"'), 'null'), ',',
		       '"id":"', ifnull(objectid, 'null'), '",',
		       getMerchantTypesJson(MerchantId),
		       '"mrchntd":"', ifnull(if(MerchantId = 2902, 'Amazon', MerchantId), 'null'), '",',
		       '"lgrl":"', ifnull(LogoUrl, 'null'), '",',
		       '"mgqlty":"', ifnull(ImageQuality, 'null'), '",',
		       '"ntwrkd":"', ifnull(NetworkId, 'null'), '",',
		       '"pprvd":"',CASE WHEN MerchantApproved IS NULL OR MerchantApproved = 0 THEN 'false' ELSE 'true' END, '",',
		       '"rl":"', ifnull(url, 'null'),'",', 
		       '"plcy":"', REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(ReturnPolicy,'\r', ''),'\n',''),'“','\\"'),'”','\\"'),'"','\\"'), '"',
		       '}'), '"null"', 'null') merchant
		FROM
		  merchant
		WHERE
		  isdirty = 1                
		]]>
            </value>
        </property>
        <property name="ingestService" ref="storeService"/>
        <property name="ingestMethod" value="saveStores"/>
        <property name="jsonType" value="com.lela.domain.document.Store"/>
        <property name="batchSize" value="10"/>
        <property name="etlUpdateQuery">
            <value>
                <![CDATA[
                update merchant set objectId = '@{id}', isdirty = -1 where MerchantId = @{tld}
                ]]>
            </value>
        </property>
    </bean>

    <!--
        DEAL INGEST JOB
    -->
    <bean id="dealEtlJobDetailTrigger" class="org.springframework.scheduling.quartz.CronTriggerBean">
        <property name="jobDetail" ref="dealEtlJobDetail"/>
        <property name="cronExpression" value="0 0 3 * * ?"/>
        <property name="misfireInstructionName" value="MISFIRE_INSTRUCTION_DO_NOTHING"/>
    </bean>

    <bean id="dealEtlJobDetail" class="com.lela.commons.jobs.etl.EtlJobDetail">
        <property name="name" value="Ingest Deal"/>
        <property name="sqlQuery">
            <value>
                <![CDATA[
		SELECT getmerchantdeals(m.merchantID) FROM merchant_deal m
		]]>
            </value>
        </property>
        <property name="ingestService" ref="dealService"/>
        <property name="ingestMethod" value="removeAndSave"/>
        <property name="jsonType" value="com.lela.domain.document.Deal"/>
        <property name="batchSize" value="5000"/>
    </bean>


   <!--
        BRANCH INGEST JOB
    -->
    <bean id="branchEtlJobDetailTrigger" class="org.springframework.scheduling.quartz.CronTriggerBean">
        <property name="jobDetail" ref="branchEtlJobDetail"/>
        <property name="cronExpression" value="0 1 3 * * ?"/>
        <property name="misfireInstructionName" value="MISFIRE_INSTRUCTION_DO_NOTHING"/>
    </bean>

    <bean id="branchEtlJobDetail" class="com.lela.commons.jobs.etl.EtlJobDetail">
        <property name="name" value="Ingest Branch"/>
        <property name="sqlQuery">
            <value>
                <![CDATA[
                SELECT replace(concat('{ "tld":"', localstoreid, '",',
                       CASE
                       WHEN l.objectID IS NOT NULL THEN
                         concat('"id":"', l.objectid, '",')
                       ELSE
                         ''
                       END,
                       '"mrchntnm":"', l.MerchantName, '",',
                       '"rlnm":"', concat(lower(replace(replace(replace(replace(replace(replace(l.MerchantName, '-', ''), '''', ''), '&', 'and'), ',', ''), '.', ''), ' ', '')), '-', l.MerchantId, '-', l.StoreNumber), '",',
                       '"mrchntd":"', ifnull(l.MerchantId, 'null'), '",',
                       '"strnmbr":"', ifnull(StoreNumber, 'null'), '",',
                       '"nm":"',
                          CASE
                            WHEN l.MerchantName IN ('Bed Bath and Beyond','BJs Wholesale Club','Kohls','Target','Sears.com') THEN
                                ifnull(concat(l.MerchantName,' ',StoreName), 'null')
                            WHEN l.MerchantName IN ('Kmart', 'Walmart') THEN
                                ifnull(concat(StoreName,' ',City), 'null')
                            ELSE ifnull(StoreName, 'null')
                          END,
                       '",',
                       '"cty":"', ifnull(l.city, 'null'), '",',
                       '"ddrss":"', ifnull(l.address, 'null'), '",',
                       '"st":"', ifnull(l.state, 'null'), '",',
                       '"zp":"', ifnull(l.ZipCode, 'null'), '",',
                       '"lclcd":"', ifnull(l.LelaLocalCode, 'null'), '",',
                       '"lclnly":"false",',
                       '"pprvd":"',
                       CASE
                       WHEN MerchantApproved IS NULL OR MerchantApproved = 0 THEN
                         'false'
                       ELSE
                         'true'
                       END, '",',
                       CASE
                       WHEN PhoneNumber IS NOT NULL THEN
                         concat('"attrs": [{ "ky": "phn", "vl": "', l.PhoneNumber, '" }], ')
                       ELSE
                         ''
                       END,
                       CASE
                       WHEN latitude IS NOT NULL && longitude IS NOT NULL THEN
                         concat('"lc": [', l.longitude, ', ', l.latitude, ']')
                       ELSE
                         ''
                       END,
                       '}'), '"null"', 'null') merchant
                FROM
                  local_store l
                LEFT JOIN merchant m
                USING (MerchantId)
                WHERE
                  l.isdirty = 1				
                ]]>
            </value>
        </property>
        <property name="ingestService" ref="branchService"/>
        <property name="ingestMethod" value="saveBranches"/>
        <property name="jsonType" value="com.lela.domain.document.Branch"/>
        <property name="batchSize" value="100"/>
        <property name="etlUpdateQuery">
            <value>
                <![CDATA[
                update local_stores set objectId = '@{id}', isdirty = -1 where localstoreid = @{tld}
                ]]>
            </value>
        </property>
    </bean>

    <!--
        CATEGORY INGEST JOB
    -->
    <bean id="categoryEtlJobDetailTrigger" class="org.springframework.scheduling.quartz.CronTriggerBean">
        <property name="jobDetail" ref="categoryEtlJobDetail"/>
        <property name="cronExpression" value="30 1 3 * * ?"/>
        <property name="misfireInstructionName" value="MISFIRE_INSTRUCTION_DO_NOTHING"/>
    </bean>

    <bean id="categoryEtlJobDetail" class="com.lela.commons.jobs.etl.EtlJobDetail">
        <property name="name" value="Ingest Category"/>
        <property name="sqlQuery">
            <value>
                <![CDATA[
                CALL IngestCategory
                ]]>
            </value>
        </property>
        <property name="ingestService" ref="categoryService"/>
        <property name="ingestMethod" value="saveCategories"/>
        <property name="jsonType" value="com.lela.domain.document.Category"/>
        <property name="batchSize" value="10"/>
        <property name="etlUpdateQuery">
            <value>
                <![CDATA[
                update category set objectId = '@{id}', isdirty = -1 where categoryid = @{tld}
                ]]>
            </value>
        </property>
    </bean>

    <!--
        FUNCTIONAL FILTER INGEST JOB
    -->
    <bean id="functionalFilterEtlJobDetailTrigger" class="org.springframework.scheduling.quartz.CronTriggerBean">
        <property name="jobDetail" ref="functionalFilterEtlJobDetail"/>
        <property name="cronExpression" value="0 2 3 * * ?"/>
        <property name="misfireInstructionName" value="MISFIRE_INSTRUCTION_DO_NOTHING"/>
    </bean>

    <bean id="functionalFilterEtlJobDetail" class="com.lela.commons.jobs.etl.EtlJobDetail">
        <property name="name" value="Ingest Functional Filter"/>
        <property name="interceptors">
            <list>
                <ref bean="allFunctionalFiltersIngestJobInterceptor"/>
            </list>
        </property>
        <property name="preExecutionQueries">
            <list>
                <value>SET SESSION group_concat_max_len = 1000000</value>
            </list>
        </property>
        <property name="sqlQuery">
            <value>
                <![CDATA[
					CALL IngestFunctionalFilter
        ]]>
            </value>
        </property>
        <property name="ingestService" ref="functionalFilterService"/>
        <property name="ingestMethod" value="saveFunctionalFilters"/>
        <property name="jsonType" value="com.lela.domain.document.FunctionalFilter"/>
        <property name="batchSize" value="10"/>

        <!-- No SQL Defined for update -->
    </bean>

    <!--
        Owner INGEST JOB
    -->
    <bean id="ownerEtlJobDetailTrigger" class="org.springframework.scheduling.quartz.CronTriggerBean">
        <property name="jobDetail" ref="ownerEtlJobDetail"/>
        <property name="cronExpression" value="30 2 3 * * ?"/>
        <property name="misfireInstructionName" value="MISFIRE_INSTRUCTION_DO_NOTHING"/>
    </bean>

    <bean id="ownerEtlJobDetail" class="com.lela.commons.jobs.etl.EtlJobDetail">
        <property name="name" value="Ingest Owner"/>
        <property name="sqlQuery">
            <value>
                <![CDATA[
                SELECT
                  GROUP_CONCAT(REPLACE(CONCAT('{"nm":"',b.BrandName, '",',
                    '"tld":"',IFNULL(b.BrandID,'null'),'",',
                '"rlnm":"',b.URLName,'",',
				'"srlnm":"', ifnull(b.LelaURL, 'null'), '",',
       		    '"id":"', ifnull(objectid, 'null'), '",',
                    '"attrs":[',
                    '{"ky":"FacebookURL", "vl":"',IFNULL(b.FacebookURL,'null'),'"},',
                    '{"ky":"TwitterURL", "vl":"',IFNULL(b.TwitterURL,'null'),'"},',
                    '{"ky":"TwitterName", "vl":"',IFNULL(b.TwitterName,'null'),'"},',
                    '{"ky":"FacebookLikes", "vl":"',IFNULL(b.FacebookLikes,'null'),'"},',
                    '{"ky":"TwitterFollowers", "vl":"',IFNULL(b.TwitterFollowers,'null'),'"},',
                    '{"ky":"PopshopsBrandID", "vl":"',IFNULL(b.PopshopsBrandID,'null'),'"}]}'),'"null"',
                 'null'))
                FROM brand b
                JOIN brand_category bc
                  ON b.BrandID = bc.BrandID
                WHERE (b.ObjectID IS NULL or b.IsDirty = 1)
                GROUP BY b.BrandID
                ]]>
            </value>
        </property>
        <property name="ingestService" ref="ownerService"/>
        <property name="ingestMethod" value="saveOwners"/>
        <property name="jsonType" value="com.lela.domain.document.Owner"/>
        <property name="batchSize" value="10"/>
        <property name="etlUpdateQuery">
            <value>
                <![CDATA[
                update brand set objectId = '@{id}', isdirty = -1 where brandid = @{tld}
                ]]>
            </value>
        </property>
    </bean>

    <!--
        QUESTION INGEST JOB
    -->
    <bean id="questionEtlJobDetailTrigger" class="org.springframework.scheduling.quartz.CronTriggerBean">
        <property name="jobDetail" ref="questionEtlJobDetail"/>
        <property name="cronExpression" value="0 3 3 * * ?"/>
        <property name="misfireInstructionName" value="MISFIRE_INSTRUCTION_DO_NOTHING"/>
    </bean>

    <bean id="questionEtlJobDetail" class="com.lela.commons.jobs.etl.EtlJobDetail">
        <property name="name" value="Ingest Question"/>
        <property name="sqlQuery">
            <value>
                <![CDATA[
SELECT
                  CONCAT(
                  '{"rlnm":"',
                  IF(sliders.URLName IS NOT NULL,sliders.URLName,
                  LOWER(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(sliders.Question,'?',''),':',''),' ',''), '''',''),'.',''))),'",',
                  '"nm":"',sliders.Question, '",',
                  '"nswrs":[',sliders.answers,'],',
                  '"tp":"',sliders.QuestionType, '",',
                  '"grp":"',sliders.QuestionGroup, '",',
                  '"lcl":"',sliders.Localization, '",',
                  '"tld":"',sliders.QuestionID,'"},') AS payload
                FROM
                (
                SELECT
                  q.isActive,
                  q.QuestionID,
                  q.Question,
                  q.QuestionType,
                  q.QuestionGroup,
                  q.Localization,
                  q.URLName,
                  GROUP_CONCAT(aa.payload) AS answers
                FROM questions q
                JOIN
                (
                SELECT q.QuestionID,
                  GROUP_CONCAT(REPLACE(CONCAT('{',
                  '"nm":"',IFNULL(a.Answer,'null'), '",',
                  '"ky":"',a.AnswerKey,'",',
                  '"mtvtrs" : {',
                  '"A":"',IFNULL(a.A,0),'",',
                  '"B":"',IFNULL(a.B,0),'",',
                  '"C":"',IFNULL(a.C,0),'",',
                  '"D":"',IFNULL(a.D,0),'",',
                  '"E":"',IFNULL(a.E,0),'",',
                  '"F":"',IFNULL(a.F,0),'",',
                  '"G":"',IFNULL(a.G,0),'",',
                  '"H":"',IFNULL(a.H,0),'",',
                  '"I":"',IFNULL(a.I,0),'",',
                  '"J":"',IFNULL(a.J,0),'",',
                  '"K":"',IFNULL(a.K,0),'",',
                  '"L":"',IFNULL(a.L,0),'"',
                  '},',
                  '"mg":"',IFNULL(a.Image,'null'),'"',
                  '}'),'"null"','null')) AS payload
                FROM questions q
                JOIN answers a ON a.QuestionID = q.QuestionID
                GROUP BY q.QuestionID, a.AnswerKey
                ) aa
                ON q.QuestionID = aa.QuestionID
                WHERE q.isActive = 1
                GROUP BY q.QuestionID
                ) sliders
                ]]>
            </value>
        </property>
        <property name="ingestService" ref="quizService"/>
        <property name="ingestMethod" value="saveQuestions"/>
        <property name="jsonType" value="com.lela.domain.document.Question"/>
        <property name="batchSize" value="10"/>

        <!-- NO UPDATE SQL -->
    </bean>

    <!--
        CAMERA INGEST JOB
    -->
    <!--
    <bean id="cameraEtlJobDetailTrigger" class="org.springframework.scheduling.quartz.CronTriggerBean">
        <property name="jobDetail" ref="cameraEtlJobDetail"/>
        <property name="cronExpression" value="0 4 3 * * ?"/>
    </bean>
    -->
    <!--
    <bean id="cameraEtlJobDetail" class="com.lela.commons.jobs.etl.EtlJobDetail">
        <property name="name" value="Ingest Camera"/>
        <property name="interceptors">
            <list>
                <ref bean="functionalFiltersIngestJobInterceptor"/>
            </list>
        </property>
        <property name="preExecutionQueries">
            <list>
                <value>call create_view_tables_CNET</value>
            </list>
        </property>

        <property name="sqlQuery">
            <value>
                <![CDATA[
                SELECT group_concat(replace(concat('{"nm":"', v.Model, '",',
                       '"lcl":"en_US",',
                       '"tp":"PRODUCT",',
                       '"tld":"', ifnull(v.CameraID, 'null'), '",',
                       '"rlnm":"', v.URLName, '",',
						'"srlnm":"', ifnull(v.LelaURL, 'null'), '",',
                       if(v.objectID IS NOT NULL, concat('"id":"', v.objectID, '",'), '"id": null,'),
                       '"sbttrs":[',
                       '{"ky":"Brand", "vl":"', ifnull(v.Brand, 'null'), '"},',
                       '{"ky":"ProductModelName", "vl":"', ifnull(v.Model, 'null'), '"},',
                       '{"ky":"ListPrice", "vl":', ifnull(v.AmazonListPrice, 'null'), '},',
                        getLowestPriceInfo_CNET(20,v.CameraID),',',
                       '{"ky":"ProductImageUrl", "vl":"', ifnull(getDefaultProductImage_CNET(20, v.CameraID), 'null'), '"}',
                       '],',
                       '"ctgry":', getCategory(20), ',',
                       '"wnr":', getOwner(20, v.BrandID), ',',
                       '"clrs":[', ifnull(getProductImages_CNET(20, v.CameraID), ''), '],',
                       IF(getProductPurchaseInfo_CNET(20,v.CameraID) IS NOT NULL,CONCAT('"mrchnts":[',getProductPurchaseInfo_CNET(20,v.CameraID),'],'),''),
                       '"strs":[',IFNULL(getStrs_CNET(20,v.CameraID),''),'],',
                       '"attrs":[',
                       ifnull(getProductDetailGroups('{"ky":"CameraType", "vl":"', 20), '{"ky":"CameraType", "vl":"'), ifnull(replace(replace(replace(v.CameraType, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"CameraTypeCompact", "vl":"', 20), '{"ky":"CameraTypeCompact", "vl":"'), ifnull(replace(replace(replace(v.CameraTypeCompact, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"CameraTypeILC", "vl":"', 20), '{"ky":"CameraTypeILC", "vl":"'), ifnull(replace(replace(replace(v.CameraTypeILC, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       if(SummaryCameraType IS NOT NULL, concat(getProductDetailGroups('{"ky":"SummaryCameraType", "vl":"', 20), SummaryCameraType, '"},'), ''),
                       ifnull(getProductDetailGroups('{"ky":"BestForIndoor", "vl":"', 20), '{"ky":"BestForIndoor", "vl":"'), ifnull(replace(replace(replace(v.BestForIndoor, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"BestForNature", "vl":"', 20), '{"ky":"BestForNature", "vl":"'), ifnull(replace(replace(replace(v.BestForNature, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"BestForTravel", "vl":"', 20), '{"ky":"BestForTravel", "vl":"'), ifnull(replace(replace(replace(v.BestForTravel, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"BestForLandscape", "vl":"', 20), '{"ky":"BestForLandscape", "vl":"'), ifnull(replace(replace(replace(v.BestForLandscape, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"BestForCloseups", "vl":"', 20), '{"ky":"BestForCloseups", "vl":"'), ifnull(replace(replace(replace(v.BestForCloseups, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"BestForBaby", "vl":"', 20), '{"ky":"BestForBaby", "vl":"'), ifnull(replace(replace(replace(v.BestForBaby, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"BestForSnowBeach", "vl":"', 20), '{"ky":"BestForSnowBeach", "vl":"'), ifnull(replace(replace(replace(v.BestForSnowBeach, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"BestForKids", "vl":"', 20), '{"ky":"BestForKids", "vl":"'), ifnull(replace(replace(replace(v.BestForKids, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       if(v.BestForSummary IS NOT NULL, concat(getProductDetailGroups('{"ky":"BestForSummary", "vl":"', 20), BestForSummary, '"},'), ''),
                       ifnull(getProductDetailGroups('{"ky":"FeatureHighImageQuality", "vl":"', 20), '{"ky":"FeatureHighImageQuality", "vl":"'), ifnull(replace(replace(replace(v.FeatureHighImageQuality, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"FeatureLargeZoomRange", "vl":"', 20), '{"ky":"FeatureLargeZoomRange", "vl":"'), ifnull(replace(replace(replace(v.FeatureLargeZoomRange, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"FeatureHighVideoQuality", "vl":"', 20), '{"ky":"FeatureHighVideoQuality", "vl":"'), ifnull(replace(replace(replace(v.FeatureHighVideoQuality, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"FeatureLargeLCDSize", "vl":"', 20), '{"ky":"FeatureLargeLCDSize", "vl":"'), ifnull(replace(replace(replace(v.FeatureLargeLCDSize, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"Feature3DCapability", "vl":"', 20), '{"ky":"Feature3DCapability", "vl":"'), ifnull(replace(replace(replace(v.Feature3DCapability, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"FeatureRuggedized", "vl":"', 20), '{"ky":"FeatureRuggedized", "vl":"'), ifnull(replace(replace(replace(v.FeatureRuggedized, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"FeatureRakes", "vl":"', 20), '{"ky":"FeatureRakes", "vl":"'), ifnull(replace(replace(replace(v.FeatureRakes, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"FeatureRechargeableBattery", "vl":"', 20), '{"ky":"FeatureRechargeableBattery", "vl":"'), ifnull(replace(replace(replace(v.FeatureRechargeableBattery, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       if(v.FeatureSummary IS NOT NULL, concat(getProductDetailGroups('{"ky":"FeatureSummary", "vl":"', 20), FeatureSummary, '"},'), ''),
                       ifnull(getProductDetailGroups('{"ky":"DesignStyle", "vl":"', 20), '{"ky":"DesignStyle", "vl":"'), ifnull(replace(replace(replace(v.DesignStyle, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"CNETModelUrl", "vl":"', 20), '{"ky":"CNETModelUrl", "vl":"'), ifnull(replace(replace(replace(v.CNETModelUrl, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"CNETMostPopular", "vl":"', 20), '{"ky":"CNETMostPopular", "vl":"'), ifnull(replace(replace(replace(v.CNETMostPopular, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"CNETEditorRating", "vl":"', 20), '{"ky":"CNETEditorRating", "vl":"'), ifnull(replace(replace(replace(v.CNETEditorRating, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"CNETUserRating", "vl":"', 20), '{"ky":"CNETUserRating", "vl":"'), ifnull(replace(replace(replace(v.CNETUserRating, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"CNETNoReviews", "vl":"', 20), '{"ky":"CNETNoReviews", "vl":"'), ifnull(replace(replace(replace(v.CNETNoReviews, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"CNETDesign", "vl":"', 20), '{"ky":"CNETDesign", "vl":"'), ifnull(replace(replace(replace(v.CNETDesign, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"CNETFeatures", "vl":"', 20), '{"ky":"CNETFeatures", "vl":"'), ifnull(replace(replace(replace(v.CNETFeatures, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"CNETPerformance", "vl":"', 20), '{"ky":"CNETPerformance", "vl":"'), ifnull(replace(replace(replace(v.CNETPerformance, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"CNETImageQuality", "vl":"', 20), '{"ky":"CNETImageQuality", "vl":"'), ifnull(replace(replace(replace(v.CNETImageQuality, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"AmazonListPrice", "vl":"', 20), '{"ky":"AmazonListPrice", "vl":"'), ifnull(replace(replace(replace(v.AmazonListPrice, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       getLowestPriceInfo_CNET(20,v.CameraID),',',
                       ifnull(getProductDetailGroups('{"ky":"dpreviewModelURL", "vl":"', 20), '{"ky":"dpreviewModelURL", "vl":"'), ifnull(replace(replace(replace(v.dpreviewModelURL, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"dpreviewRating", "vl":"', 20), '{"ky":"dpreviewRating", "vl":"'), ifnull(replace(replace(replace(v.dpreviewRating, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"dpreviewPct", "vl":"', 20), '{"ky":"dpreviewPct", "vl":"'), ifnull(replace(replace(replace(v.dpreviewPct, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"CRModelURL", "vl":"', 20), '{"ky":"CRModelURL", "vl":"'), ifnull(replace(replace(replace(v.CRModelURL, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"CRTested", "vl":"', 20), '{"ky":"CRTested", "vl":"'), ifnull(replace(replace(replace(v.CRTested, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"CROverallScore", "vl":"', 20), '{"ky":"CROverallScore", "vl":"'), ifnull(replace(replace(replace(v.CROverallScore, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"CReportsFlashPhotos", "vl":"', 20), '{"ky":"CReportsFlashPhotos", "vl":"'), ifnull(replace(replace(replace(v.CReportsFlashPhotos, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"CRVersatility", "vl":"', 20), '{"ky":"CRVersatility", "vl":"'), ifnull(replace(replace(replace(v.CRVersatility, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"CRBatteryLife", "vl":"', 20), '{"ky":"CRBatteryLife", "vl":"'), ifnull(replace(replace(replace(v.CRBatteryLife, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"CRVideoQuality", "vl":"', 20), '{"ky":"CRVideoQuality", "vl":"'), ifnull(replace(replace(replace(v.CRVideoQuality, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"CRLCDQuality", "vl":"', 20), '{"ky":"CRLCDQuality", "vl":"'), ifnull(replace(replace(replace(v.CRLCDQuality, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"CRImageQuality", "vl":"', 20), '{"ky":"CRImageQuality", "vl":"'), ifnull(replace(replace(replace(v.CRImageQuality, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"CREaseofUse", "vl":"', 20), '{"ky":"CREaseofUse", "vl":"'), ifnull(replace(replace(replace(v.CREaseofUse, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"TechliciousRated", "vl":"', 20), '{"ky":"TechliciousRated", "vl":"'), ifnull(replace(replace(replace(v.TechliciousRated, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"BHMostPopular", "vl":"', 20), '{"ky":"BHMostPopular", "vl":"'), ifnull(replace(replace(replace(v.BHMostPopular, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"BHPhotoRating", "vl":"', 20), '{"ky":"BHPhotoRating", "vl":"'), ifnull(replace(replace(replace(v.BHPhotoRating, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"BabbleRecommended", "vl":"', 20), '{"ky":"BabbleRecommended", "vl":"'), ifnull(replace(replace(replace(v.BabbleRecommended, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"FacebookURL", "vl":"', 20), '{"ky":"FacebookURL", "vl":"'), ifnull(replace(replace(replace(v.FacebookURL, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"TwitterURL", "vl":"', 20), '{"ky":"TwitterURL", "vl":"'), ifnull(replace(replace(replace(v.TwitterURL, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"TwitterName", "vl":"', 20), '{"ky":"TwitterName", "vl":"'), ifnull(replace(replace(replace(v.TwitterName, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"AmazonASIN", "vl":"', 20), '{"ky":"AmazonASIN", "vl":"'), ifnull(replace(replace(replace(v.AmazonASIN, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"Description", "vl":"', 20), '{"ky":"Description", "vl":"'), ifnull(replace(replace(replace(v.Description, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"ProductDescription", "vl":"', 20), '{"ky":"ProductDescription", "vl":"'), ifnull(replace(replace(replace(v.ProductDescription, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"ProductOverview", "vl":"', 20), '{"ky":"ProductOverview", "vl":"'), ifnull(replace(replace(replace(v.ProductOverview, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"FocusAdjustment", "vl":"', 20), '{"ky":"FocusAdjustment", "vl":"'), ifnull(replace(replace(replace(v.FocusAdjustment, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"ImageProcessor", "vl":"', 20), '{"ky":"ImageProcessor", "vl":"'), ifnull(replace(replace(replace(v.ImageProcessor, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"ImageStabType", "vl":"', 20), '{"ky":"ImageStabType", "vl":"'), ifnull(replace(replace(replace(v.ImageStabType, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"IncludedMemoryCard", "vl":"', 20), '{"ky":"IncludedMemoryCard", "vl":"'), ifnull(replace(replace(replace(v.IncludedMemoryCard, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"InternalStorage", "vl":"', 20), '{"ky":"InternalStorage", "vl":"'), ifnull(replace(replace(replace(v.InternalStorage, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"LANandWirelessImageTransferringProtocols", "vl":"', 20), '{"ky":"LANandWirelessImageTransferringProtocols", "vl":"'), ifnull(replace(replace(replace(v.LANandWirelessImageTransferringProtocols, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"LensSystem", "vl":"', 20), '{"ky":"LensSystem", "vl":"'), ifnull(replace(replace(replace(v.LensSystem, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"MaximumVideoResolution", "vl":"', 20), '{"ky":"MaximumVideoResolution", "vl":"'), ifnull(replace(replace(replace(v.MaximumVideoResolution, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"MinFocusRange", "vl":"', 20), '{"ky":"MinFocusRange", "vl":"'), ifnull(replace(replace(replace(v.MinFocusRange, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"ProductType", "vl":"', 20), '{"ky":"ProductType", "vl":"'), ifnull(replace(replace(replace(v.ProductType, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"SensorResolution", "vl":"', 20), '{"ky":"SensorResolution", "vl":"'), ifnull(replace(replace(replace(v.SensorResolution, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"BatteryType", "vl":"', 20), '{"ky":"BatteryType", "vl":"'), ifnull(replace(replace(replace(v.BatteryType, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"AdditionalFeatures", "vl":"', 20), '{"ky":"AdditionalFeatures", "vl":"'), ifnull(replace(replace(replace(v.AdditionalFeatures, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"AdditionalFeatures_FlashTerminal", "vl":"', 20), '{"ky":"AdditionalFeatures_FlashTerminal", "vl":"'), ifnull(replace(replace(replace(v.AdditionalFeatures_FlashTerminal, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"CameraFlash_EffectiveFlashRange", "vl":"', 20), '{"ky":"CameraFlash_EffectiveFlashRange", "vl":"'), ifnull(replace(replace(replace(v.CameraFlash_EffectiveFlashRange, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"CameraFlash_Features", "vl":"', 20), '{"ky":"CameraFlash_Features", "vl":"'), ifnull(replace(replace(replace(v.CameraFlash_Features, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"CameraFlash_FlashModes", "vl":"', 20), '{"ky":"CameraFlash_FlashModes", "vl":"'), ifnull(replace(replace(replace(v.CameraFlash_FlashModes, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"CameraFlash_GuideNumbermISO100", "vl":"', 20), '{"ky":"CameraFlash_GuideNumbermISO100", "vl":"'), ifnull(replace(replace(replace(v.CameraFlash_GuideNumbermISO100, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"OutputConnections", "vl":"', 20), '{"ky":"OutputConnections", "vl":"'), ifnull(replace(replace(replace(v.OutputConnections, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"ScreenResolution", "vl":"', 20), '{"ky":"ScreenResolution", "vl":"'), ifnull(replace(replace(replace(v.ScreenResolution, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"General_BodyMaterial", "vl":"', 20), '{"ky":"General_BodyMaterial", "vl":"'), ifnull(replace(replace(replace(v.General_BodyMaterial, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"LensSystem2nd_Features", "vl":"', 20), '{"ky":"LensSystem2nd_Features", "vl":"'), ifnull(replace(replace(replace(v.LensSystem2nd_Features, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"LensSystem_Features", "vl":"', 20), '{"ky":"LensSystem_Features", "vl":"'), ifnull(replace(replace(replace(v.LensSystem_Features, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"LensSystem_LensManufacturer", "vl":"', 20), '{"ky":"LensSystem_LensManufacturer", "vl":"'), ifnull(replace(replace(replace(v.LensSystem_LensManufacturer, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"AutoType", "vl":"', 20), '{"ky":"AutoType", "vl":"'), ifnull(replace(replace(replace(v.AutoType, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"ContinuousShootSpeed", "vl":"', 20), '{"ky":"ContinuousShootSpeed", "vl":"'), ifnull(replace(replace(replace(v.ContinuousShootSpeed, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"MainFeatures_FaceDetection", "vl":"', 20), '{"ky":"MainFeatures_FaceDetection", "vl":"'), ifnull(replace(replace(replace(v.MainFeatures_FaceDetection, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"MainFeatures_X_syncSpeed", "vl":"', 20), '{"ky":"MainFeatures_X_syncSpeed", "vl":"'), ifnull(replace(replace(replace(v.MainFeatures_X_syncSpeed, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"DimensionsWxDxH", "vl":"', 20), '{"ky":"DimensionsWxDxH", "vl":"'), ifnull(replace(replace(replace(v.DimensionsWxDxH, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"Weight", "vl":"', 20), '{"ky":"Weight", "vl":"'), ifnull(replace(replace(replace(v.Weight, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"LensSystem_FocalLengthEquivalentto35mmCamera", "vl":"', 20), '{"ky":"LensSystem_FocalLengthEquivalentto35mmCamera", "vl":"'), ifnull(replace(replace(replace(v.LensSystem_FocalLengthEquivalentto35mmCamera, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"LensSystem_MacroFocusRange", "vl":"', 20), '{"ky":"LensSystem_MacroFocusRange", "vl":"'), ifnull(replace(replace(replace(v.LensSystem_MacroFocusRange, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"AudioInput_MicrophoneOperationMode", "vl":"', 20), '{"ky":"AudioInput_MicrophoneOperationMode", "vl":"'), ifnull(replace(replace(replace(v.AudioInput_MicrophoneOperationMode, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"AudioInput_Type", "vl":"', 20), '{"ky":"AudioInput_Type", "vl":"'), ifnull(replace(replace(replace(v.AudioInput_Type, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"Battery_BatteryFormFactor", "vl":"', 20), '{"ky":"Battery_BatteryFormFactor", "vl":"'), ifnull(replace(replace(replace(v.Battery_BatteryFormFactor, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"Battery_SupportedBatteryFormFactor", "vl":"', 20), '{"ky":"Battery_SupportedBatteryFormFactor", "vl":"'), ifnull(replace(replace(replace(v.Battery_SupportedBatteryFormFactor, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"CameraFlash_RedEyeReduction", "vl":"', 20), '{"ky":"CameraFlash_RedEyeReduction", "vl":"'), ifnull(replace(replace(replace(v.CameraFlash_RedEyeReduction, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"CameraFlash_Type", "vl":"', 20), '{"ky":"CameraFlash_Type", "vl":"'), ifnull(replace(replace(replace(v.CameraFlash_Type, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"DigitalCamera_DigitalCameraType", "vl":"', 20), '{"ky":"DigitalCamera_DigitalCameraType", "vl":"'), ifnull(replace(replace(replace(v.DigitalCamera_DigitalCameraType, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"DigitalCamera_SupportedFlashMemory", "vl":"', 20), '{"ky":"DigitalCamera_SupportedFlashMemory", "vl":"'), ifnull(replace(replace(replace(v.DigitalCamera_SupportedFlashMemory, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"Dimensions_Weight_Depth", "vl":"', 20), '{"ky":"Dimensions_Weight_Depth", "vl":"'), ifnull(replace(replace(replace(v.Dimensions_Weight_Depth, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"Dimensions_Weight_Height", "vl":"', 20), '{"ky":"Dimensions_Weight_Height", "vl":"'), ifnull(replace(replace(replace(v.Dimensions_Weight_Height, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"Dimensions_Weight_Weight", "vl":"', 20), '{"ky":"Dimensions_Weight_Weight", "vl":"'), ifnull(replace(replace(replace(v.Dimensions_Weight_Weight, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"Dimensions_Weight_Width", "vl":"', 20), '{"ky":"Dimensions_Weight_Width", "vl":"'), ifnull(replace(replace(replace(v.Dimensions_Weight_Width, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"ScreenSize", "vl":"', 20), '{"ky":"ScreenSize", "vl":"'), ifnull(replace(replace(replace(v.ScreenSize, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"DisplayProjector_DiagonalSizemetric", "vl":"', 20), '{"ky":"DisplayProjector_DiagonalSizemetric", "vl":"'), ifnull(replace(replace(replace(v.DisplayProjector_DiagonalSizemetric, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"DisplayProjector_DisplayFormFactor", "vl":"', 20), '{"ky":"DisplayProjector_DisplayFormFactor", "vl":"'), ifnull(replace(replace(replace(v.DisplayProjector_DisplayFormFactor, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"DisplayProjector_Type", "vl":"', 20), '{"ky":"DisplayProjector_Type", "vl":"'), ifnull(replace(replace(replace(v.DisplayProjector_Type, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"FlashMemory_FormFactor", "vl":"', 20), '{"ky":"FlashMemory_FormFactor", "vl":"'), ifnull(replace(replace(replace(v.FlashMemory_FormFactor, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"FlashMemory_StorageCapacity", "vl":"', 20), '{"ky":"FlashMemory_StorageCapacity", "vl":"'), ifnull(replace(replace(replace(v.FlashMemory_StorageCapacity, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"LensApertureRange", "vl":"', 20), '{"ky":"LensApertureRange", "vl":"'), ifnull(replace(replace(replace(v.LensApertureRange, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"LensSystem_OpticalZoom", "vl":"', 20), '{"ky":"LensSystem_OpticalZoom", "vl":"'), ifnull(replace(replace(replace(v.LensSystem_OpticalZoom, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"OpticalZoom", "vl":"', 20), '{"ky":"OpticalZoom", "vl":"'), ifnull(replace(replace(replace(v.OpticalZoom, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"LensSystem_Type", "vl":"', 20), '{"ky":"LensSystem_Type", "vl":"'), ifnull(replace(replace(replace(v.LensSystem_Type, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"MaximumImageResolution", "vl":"', 20), '{"ky":"MaximumImageResolution", "vl":"'), ifnull(replace(replace(replace(v.MaximumImageResolution, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"OpticalSensor_SensorResolution", "vl":"', 20), '{"ky":"OpticalSensor_SensorResolution", "vl":"'), ifnull(replace(replace(replace(v.OpticalSensor_SensorResolution, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"OpticalViewfinder_Type", "vl":"', 20), '{"ky":"OpticalViewfinder_Type", "vl":"'), ifnull(replace(replace(replace(v.OpticalViewfinder_Type, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"VideoInput_DigitalZoom", "vl":"', 20), '{"ky":"VideoInput_DigitalZoom", "vl":"'), ifnull(replace(replace(replace(v.VideoInput_DigitalZoom, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"MaximumISO", "vl":"', 20), '{"ky":"MaximumISO", "vl":"'), ifnull(replace(replace(replace(v.MaximumISO, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"VideoInput_LightSensitivity", "vl":"', 20), '{"ky":"VideoInput_LightSensitivity", "vl":"'), ifnull(replace(replace(replace(v.VideoInput_LightSensitivity, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"VideoInput_StillImageFormat", "vl":"', 20), '{"ky":"VideoInput_StillImageFormat", "vl":"'), ifnull(replace(replace(replace(v.VideoInput_StillImageFormat, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"VideoInput_Type", "vl":"', 20), '{"ky":"VideoInput_Type", "vl":"'), ifnull(replace(replace(replace(v.VideoInput_Type, '\r', ''), '\n', ''), '\t', ''), 'null'), '"},',
                       ifnull(getProductDetailGroups('{"ky":"Viewfinder_ViewfinderType", "vl":"', 20), '{"ky":"Viewfinder_ViewfinderType", "vl":"'), ifnull(replace(replace(replace(v.Viewfinder_ViewfinderType, '\r', ''), '\n', ''), '\t', ''), 'null'), '"}],',
                       '"mtvtrs" : {',
                       '"A":', ifnull(m.A, 0), ',',
                       '"B":', ifnull(m.B, 0), ',',
                       '"C":', ifnull(m.C, 0), ',',
                       '"E":', ifnull(m.E, 0), ',',
                       '"F":', ifnull(m.F, 0), ',',
                       '"G":', ifnull(m.G, 0), ',',
                       '"H":', ifnull(m.H, 0), ',',
                       '"I":', ifnull(m.I, 0), ',',
                       '"J":', ifnull(m.J, 0), ',',
                       '"K":', ifnull(m.K, 0), ',',
                       '"L":', ifnull(m.L, 0), '',
                       '}}'), '"null"', 'null')) AS payload
                FROM
                  vw_cameras_data_ui v
                JOIN vw_camera_motivators m
                ON v.CameraID = m.ItemID AND
                m.CategoryID = v.CategoryID
                WHERE
                  getLowestPriceInfo_CNET(20,v.CameraID) IS NOT NULL
                GROUP BY v.CameraID;
                ]]>
            </value>
        </property>
        <property name="ingestService" ref="itemService"/>
        <property name="ingestMethod" value="saveItems"/>
        <property name="jsonType" value="com.lela.domain.document.Item"/>
        <property name="batchSize" value="10"/>
        <property name="etlUpdateQuery">
            <value>
                <![CDATA[
                update cameras_data set objectId = '@{id}', isdirty = -1 where cameraid = @{tld}
                ]]>
            </value>
        </property>
    </bean>
    -->
    <!--
        CARRIER INGEST JOB
    -->
    <!--
    <bean id="carrierEtlJobDetailTrigger" class="org.springframework.scheduling.quartz.CronTriggerBean">
        <property name="jobDetail" ref="carrierEtlJobDetail"/>
        <property name="cronExpression" value="0 4 3 * * ?"/>
    </bean>
    -->
    <!--
    <bean id="carrierEtlJobDetail" class="com.lela.commons.jobs.etl.EtlJobDetail">
        <property name="name" value="Ingest Carrier"/>
        <property name="interceptors">
            <list>
                <ref bean="functionalFiltersIngestJobInterceptor"/>
            </list>
        </property>
        <property name="preExecutionQueries">
            <list>
                <value>call create_view_tables</value>
            </list>
        </property>
        <property name="sqlQuery">
            <value>
                <![CDATA[
                SELECT
                  GROUP_CONCAT(REPLACE(CONCAT('{"nm":"',v.Model, '",',
                '"lcl":"en_US",',
                '"tp":"PRODUCT",',
                '"tld":"',IFNULL(v.CarrierID,'null'),'",',
                '"rlnm":"',v.URLName,'",',
				'"srlnm":"', ifnull(v.LelaURL, 'null'), '",',
                IF(v.objectID IS NOT NULL,CONCAT('"id":"',v.objectID,'",'),'"id": null,'),
                '"sbttrs":[',
                '{"ky":"Brand", "vl":"',IFNULL(v.Brand,'null'),'"},',
                '{"ky":"ProductModelName", "vl":"',IFNULL(v.Model,'null'),'"},',
                '{"ky":"ListPrice", "vl":',IFNULL(CAST(REPLACE(v.ListPrice,'$','') AS DECIMAL(8,2)),'null'),'},',
                getLowestPriceInfo(13,v.CarrierID),',',
                '{"ky":"ProductImageUrl", "vl":"',IFNULL(getDefaultProductImage(13,v.CarrierID),'null'),'"}',
                '],',
                '"ctgry":',getCategory(13),',',
                '"wnr":',getOwner(13,v.BrandID),',',
                '"clrs":[',IFNULL(getProductImages(13,v.CarrierID),''),'],',
                IF(getProductPurchaseInfo(13,v.CarrierID) IS NOT NULL,CONCAT('"mrchnts":[',getProductPurchaseInfo(13,v.CarrierID),'],'),''),
                '"strs":[',IFNULL(getStrs(13,v.CarrierID),''),'],',
                '"attrs":[',
                IFNULL(getProductDetailGroups('{"ky":"Model", "vl":"',13),'{"ky":"Model", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.Model,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ModelNumber", "vl":"',13),'{"ky":"ModelNumber", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.ModelNumber,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CarrierType", "vl":"',13),'{"ky":"CarrierType", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.CarrierType,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CarrierTypeSlingsAndPouches", "vl":"',13),'{"ky":"CarrierTypeSlingsAndPouches", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.CarrierTypeSlingsAndPouches,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CarrierTypeMeiTaiOrAsian", "vl":"',13),'{"ky":"CarrierTypeMeiTaiOrAsian", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.CarrierTypeMeiTaiOrAsian,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CarrierTypeWrapAround", "vl":"',13),'{"ky":"CarrierTypeWrapAround", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.CarrierTypeWrapAround,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CarrierTypeSoftCarriers", "vl":"',13),'{"ky":"CarrierTypeSoftCarriers", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.CarrierTypeSoftCarriers,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CarrierTypeFrameCarriers", "vl":"',13),'{"ky":"CarrierTypeFrameCarriers", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.CarrierTypeFrameCarriers,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"SafetyCertification", "vl":"',13),'{"ky":"SafetyCertification", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.SafetyCertification,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IF(SummaryCarrierType IS NOT NULL,CONCAT(getProductDetailGroups('{"ky":"SummaryCarrierType", "vl":"',13),SummaryCarrierType,'"},'),''),
                IFNULL(getProductDetailGroups('{"ky":"BestForNewborns", "vl":"',13),'{"ky":"BestForNewborns", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.BestForNewborns,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BestForToddlers", "vl":"',13),'{"ky":"BestForToddlers", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.BestForToddlers,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BestForPetiteParents", "vl":"',13),'{"ky":"BestForPetiteParents", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.BestForPetiteParents,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BestForTallParents", "vl":"',13),'{"ky":"BestForTallParents", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.BestForTallParents,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BestForOutdoor", "vl":"',13),'{"ky":"BestForOutdoor", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.BestForOutdoor,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IF(v.BestForSummary IS NOT NULL,CONCAT(getProductDetailGroups('{"ky":"BestForSummary", "vl":"',13),BestForSummary,'"},'),''),
                IFNULL(getProductDetailGroups('{"ky":"FeatureModern", "vl":"',13),'{"ky":"FeatureModern", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.FeatureModern,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"FeatureComfyParent", "vl":"',13),'{"ky":"FeatureComfyParent", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.FeatureComfyParent,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"FeatureGrowsWithChild", "vl":"',13),'{"ky":"FeatureGrowsWithChild", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.FeatureGrowsWithChild,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"FeatureReversible", "vl":"',13),'{"ky":"FeatureReversible", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.FeatureReversible,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"FeatureOrganic", "vl":"',13),'{"ky":"FeatureOrganic", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.FeatureOrganic,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"FeaturePacifierStorage", "vl":"',13),'{"ky":"FeaturePacifierStorage", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.FeaturePacifierStorage,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IF(v.StyleFeatureSummary IS NOT NULL,CONCAT(getProductDetailGroups('{"ky":"StyleFeatureSummary", "vl":"',13),StyleFeatureSummary,'"},'),''),
                IFNULL(getProductDetailGroups('{"ky":"Priority", "vl":"',13),'{"ky":"Priority", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.Priority,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BBBrandRating", "vl":"',13),'{"ky":"BBBrandRating", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.BBBrandRating,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BBModelRecommended", "vl":"',13),'{"ky":"BBModelRecommended", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.BBModelRecommended,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BabbleRecomended", "vl":"',13),'{"ky":"BabbleRecomended", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.BabbleRecomended,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"GigglesListed", "vl":"',13),'{"ky":"GigglesListed", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.GigglesListed,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"AvailableAmazon", "vl":"',13),'{"ky":"AvailableAmazon", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.AvailableAmazon,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ASIN", "vl":"',13),'{"ky":"ASIN", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.ASIN,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"AmazonBestseller", "vl":"',13),'{"ky":"AmazonBestseller", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.AmazonBestseller,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"AmazonCustomerRating", "vl":"',13),'{"ky":"AmazonCustomerRating", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.AmazonCustomerRating,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BRUsBestseller", "vl":"',13),'{"ky":"BRUsBestseller", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.BRUsBestseller,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BRUSTopRated", "vl":"',13),'{"ky":"BRUSTopRated", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.BRUSTopRated,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"NAPPAAwardWinner", "vl":"',13),'{"ky":"NAPPAAwardWinner", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.NAPPAAwardWinner,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"JPMAInnovationAwardWinner", "vl":"',13),'{"ky":"JPMAInnovationAwardWinner", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.JPMAInnovationAwardWinner,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"PTPAAwardWinner", "vl":"',13),'{"ky":"PTPAAwardWinner", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.PTPAAwardWinner,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"iParentingMediaAwardWinner", "vl":"',13),'{"ky":"iParentingMediaAwardWinner", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.iParentingMediaAwardWinner,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"DesignStyle", "vl":"',13),'{"ky":"DesignStyle", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.DesignStyle,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BrandURL", "vl":"',13),'{"ky":"BrandURL", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.BrandURL,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ModelURL", "vl":"',13),'{"ky":"ModelURL", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.ModelURL,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BrandLevelMarketingPosition", "vl":"',13),'{"ky":"BrandLevelMarketingPosition", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.BrandLevelMarketingPosition,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CollectionLevelMarketingPositon", "vl":"',13),'{"ky":"CollectionLevelMarketingPositon", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.CollectionLevelMarketingPositon,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ProductOverview", "vl":"',13),'{"ky":"ProductOverview", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.ProductOverview,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"Country", "vl":"',13),'{"ky":"Country", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.Country,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"JPMACertified", "vl":"',13),'{"ky":"JPMACertified", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.JPMACertified,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ASTM", "vl":"',13),'{"ky":"ASTM", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.ASTM,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"TUV", "vl":"',13),'{"ky":"TUV", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.TUV,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"Oeko_TexStandard100", "vl":"',13),'{"ky":"Oeko_TexStandard100", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.Oeko_TexStandard100,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RecallEvent", "vl":"',13),'{"ky":"RecallEvent", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.RecallEvent,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RecallURL", "vl":"',13),'{"ky":"RecallURL", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.RecallURL,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RecallDate", "vl":"',13),'{"ky":"RecallDate", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.RecallDate,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RecallUnits", "vl":"',13),'{"ky":"RecallUnits", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.RecallUnits,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RecallHazard", "vl":"',13),'{"ky":"RecallHazard", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.RecallHazard,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RecallIncidents", "vl":"',13),'{"ky":"RecallIncidents", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.RecallIncidents,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RecallSeverity", "vl":"',13),'{"ky":"RecallSeverity", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.RecallSeverity,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ColorsNeon", "vl":"',13),'{"ky":"ColorsNeon", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.ColorsNeon,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ColorsVeryBrightORPrimary", "vl":"',13),'{"ky":"ColorsVeryBrightORPrimary", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.ColorsVeryBrightORPrimary,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ColorsNeutral", "vl":"',13),'{"ky":"ColorsNeutral", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.ColorsNeutral,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ColorsDeepBluePurples", "vl":"',13),'{"ky":"ColorsDeepBluePurples", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.ColorsDeepBluePurples,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ColorsGrayBlack", "vl":"',13),'{"ky":"ColorsGrayBlack", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.ColorsGrayBlack,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"TotalColors", "vl":"',13),'{"ky":"TotalColors", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.TotalColors,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ManufacturerColorNames", "vl":"',13),'{"ky":"ManufacturerColorNames", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.ManufacturerColorNames,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"MinimumAge", "vl":"',13),'{"ky":"MinimumAge", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.MinimumAge,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"MaximumAge", "vl":"',13),'{"ky":"MaximumAge", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.MaximumAge,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"MinimumWeight", "vl":"',13),'{"ky":"MinimumWeight", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.MinimumWeight,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"MaximumWeight", "vl":"',13),'{"ky":"MaximumWeight", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.MaximumWeight,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"MinimumHeight", "vl":"',13),'{"ky":"MinimumHeight", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.MinimumHeight,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"MaximumHeight", "vl":"',13),'{"ky":"MaximumHeight", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.MaximumHeight,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ParentMinimumHeight", "vl":"',13),'{"ky":"ParentMinimumHeight", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.ParentMinimumHeight,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ParentMaximumHeight", "vl":"',13),'{"ky":"ParentMaximumHeight", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.ParentMaximumHeight,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ParentMinimumWaist", "vl":"',13),'{"ky":"ParentMinimumWaist", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.ParentMinimumWaist,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ParentMaximumWaist", "vl":"',13),'{"ky":"ParentMaximumWaist", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.ParentMaximumWaist,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"Positions", "vl":"',13),'{"ky":"Positions", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.Positions,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"AdjustableSeating", "vl":"',13),'{"ky":"AdjustableSeating", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.AdjustableSeating,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"MachineWashable", "vl":"',13),'{"ky":"MachineWashable", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.MachineWashable,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"PaddedStraps", "vl":"',13),'{"ky":"PaddedStraps", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.PaddedStraps,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"AdjustableStraps", "vl":"',13),'{"ky":"AdjustableStraps", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.AdjustableStraps,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"StrapOrientation", "vl":"',13),'{"ky":"StrapOrientation", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.StrapOrientation,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"WeightDistribution", "vl":"',13),'{"ky":"WeightDistribution", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.WeightDistribution,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RemovableFront", "vl":"',13),'{"ky":"RemovableFront", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.RemovableFront,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"SideEntry", "vl":"',13),'{"ky":"SideEntry", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.SideEntry,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IF(v.InfantInsert IS NOT NULL,CONCAT(getProductDetailGroupsAccessories(13,'{"ky":"InfantInsert", "vl":"',InfantInsert),v.InfantInsert,'"},'),''),
                IFNULL(getProductDetailGroups('{"ky":"HeadSupport", "vl":"',13),'{"ky":"HeadSupport", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.HeadSupport,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"Reversible", "vl":"',13),'{"ky":"Reversible", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.Reversible,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"Convertible", "vl":"',13),'{"ky":"Convertible", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.Convertible,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"FabricType", "vl":"',13),'{"ky":"FabricType", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.FabricType,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"PaddedFabric", "vl":"',13),'{"ky":"PaddedFabric", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.PaddedFabric,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"Ventilation", "vl":"',13),'{"ky":"Ventilation", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.Ventilation,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IF(v.AdultCupHolder IS NOT NULL,CONCAT(getProductDetailGroupsAccessories(13,'{"ky":"AdultCupHolder", "vl":"',AdultCupHolder),v.AdultCupHolder,'"},'),''),
                IF(v.PacifierHolder IS NOT NULL,CONCAT(getProductDetailGroupsAccessories(13,'{"ky":"PacifierHolder", "vl":"',PacifierHolder),v.PacifierHolder,'"},'),''),
                IFNULL(getProductDetailGroups('{"ky":"Canopy", "vl":"',13),'{"ky":"Canopy", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.Canopy,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IF(v.Bib IS NOT NULL,CONCAT(getProductDetailGroupsAccessories(13,'{"ky":"Bib", "vl":"',Bib),v.Bib,'"},'),''),
                IF(v.RainCover IS NOT NULL,CONCAT(getProductDetailGroupsAccessories(13,'{"ky":"RainCover", "vl":"',RainCover),v.RainCover,'"},'),''),
                IF(v.SunCover IS NOT NULL,CONCAT(getProductDetailGroupsAccessories(13,'{"ky":"SunCover", "vl":"',SunCover),v.SunCover,'"},'),''),
                IFNULL(getProductDetailGroups('{"ky":"ListPrice", "vl":"',13),'{"ky":"ListPrice", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.ListPrice,'\r',''),'\n',''),'\t',''),'null'),'"},',
                getLowestPriceInfo(13,v.CarrierID),',',
                IFNULL(getProductDetailGroups('{"ky":"ListPriceRange", "vl":"',13),'{"ky":"ListPriceRange", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.ListPriceRange,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"SalePrice", "vl":"',13),'{"ky":"SalePrice", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.SalePrice,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"NewModelDiscount", "vl":"',13),'{"ky":"NewModelDiscount", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.NewModelDiscount,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"SourceURLDiscountedModel", "vl":"',13),'{"ky":"SourceURLDiscountedModel", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.SourceURLDiscountedModel,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"FacebookURL", "vl":"',13),'{"ky":"FacebookURL", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.FacebookURL,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BrandFacebookLikes", "vl":"',13),'{"ky":"BrandFacebookLikes", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.BrandFacebookLikes,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"TwitterName", "vl":"',13),'{"ky":"TwitterName", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.TwitterName,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"TwitterURL", "vl":"',13),'{"ky":"TwitterURL", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.TwitterURL,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BrandTwitterFollowers", "vl":"',13),'{"ky":"BrandTwitterFollowers", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.BrandTwitterFollowers,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"YoutubeChannelURL", "vl":"',13),'{"ky":"YoutubeChannelURL", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.YoutubeChannelURL,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"YoutubeChannelSubscribers", "vl":"',13),'{"ky":"YoutubeChannelSubscribers", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.YoutubeChannelSubscribers,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"YoutubeChannelViews", "vl":"',13),'{"ky":"YoutubeChannelViews", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.YoutubeChannelViews,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"YoutubeChannelUploadViews", "vl":"',13),'{"ky":"YoutubeChannelUploadViews", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.YoutubeChannelUploadViews,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ControlUnion", "vl":"',13),'{"ky":"ControlUnion", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.ControlUnion,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CPSIACompliance", "vl":"',13),'{"ky":"CPSIACompliance", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.CPSIACompliance,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"SGSCSTC", "vl":"',13),'{"ky":"SGSCSTC", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.SGSCSTC,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"EN", "vl":"',13),'{"ky":"EN", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.EN,'\r',''),'\n',''),'\t',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CelebrityOwned", "vl":"',13),'{"ky":"CelebrityOwned", "vl":"'),IFNULL(REPLACE(REPLACE(REPLACE(v.CelebrityOwned,'\r',''),'\n',''),'\t',''),'null'),'"}],',
                '"mtvtrs" : {',
                '"A":',IFNULL(m.A,0),',',
                '"B":',IFNULL(m.B,0),',',
                '"C":',IFNULL(m.C,0),',',
                '"E":',IFNULL(m.E,0),',',
                '"F":',IFNULL(m.F,0),',',
                '"G":',IFNULL(m.G,0),',',
                '"H":',IFNULL(m.H,0),',',
                '"I":',IFNULL(m.I,0),',',
                '"J":',IFNULL(m.J,0),',',
                '"K":',IFNULL(m.K,0),',',
                '"L":',IFNULL(m.L,0),'',
                '}}'),'"null"','null')) AS payload
                FROM vw_carrier_data_ui v
                JOIN vw_carrier_motivators m
                  ON v.CarrierID = m.ItemID AND
                  m.CategoryID = v.CategoryID
                WHERE getDefaultProductImage(13,v.CarrierID) IS NOT NULL
                AND getLowestPriceInfo(13,v.CarrierID) IS NOT NULL
                AND (v.IsDirty = 1 or imagesDirty(13,v.CarrierID))
                GROUP BY v.CarrierID
                ]]>
            </value>
        </property>
        <property name="ingestService" ref="itemService"/>
        <property name="ingestMethod" value="saveItems"/>
        <property name="jsonType" value="com.lela.domain.document.Item"/>
        <property name="batchSize" value="10"/>
        <property name="etlUpdateQuery">
            <value>
                <![CDATA[
                update carrier_data set objectId = '@{id}', isdirty = -1 where carrierid = @{tld}
                ]]>
            </value>
        </property>
    </bean>
    -->
    <!--
        BABY MONITOR INGEST JOB
    -->
    <!--
    <bean id="babymonitorEtlJobDetailTrigger" class="org.springframework.scheduling.quartz.CronTriggerBean">
        <property name="jobDetail" ref="babymonitorEtlJobDetail"/>
        <property name="cronExpression" value="0 4 3 * * ?"/>
    </bean>
    -->
    <!--
    <bean id="babymonitorEtlJobDetail" class="com.lela.commons.jobs.etl.EtlJobDetail">
        <property name="name" value="Ingest Baby Monitor"/>
        <property name="interceptors">
            <list>
                <ref bean="functionalFiltersIngestJobInterceptor"/>
            </list>
        </property>
        <property name="preExecutionQueries">
            <list>
                <value>call create_view_tables</value>
            </list>
        </property>
        <property name="sqlQuery">
            <value>
                <![CDATA[
                SELECT
                  GROUP_CONCAT(REPLACE(CONCAT('{"nm":"',v.ProductModelName, '",',
                '"lcl":"en_US",',
                '"tp":"PRODUCT",',
                '"tld":"',IFNULL(v.BabyMonitorID,'null'),'",',
                '"rlnm":"',v.URLName,'",',
				'"srlnm":"', ifnull(v.LelaURL, 'null'), '",',
                IF(v.objectID IS NOT NULL,CONCAT('"id":"',v.objectID,'",'),'"id": null,'),
                '"sbttrs":[',
                '{"ky":"Brand", "vl":"',IFNULL(v.Brand,'null'),'"},',
                '{"ky":"ProductModelName", "vl":"',IFNULL(v.ProductModelName,'null'),'"},',
                '{"ky":"ListPrice", "vl":',IFNULL(CAST(REPLACE(v.ListPrice,'$','') AS DECIMAL(8,2)),'null'),'},',
                getLowestPriceInfo(14,v.BabyMonitorID),',',
                '{"ky":"ProductImageUrl", "vl":"',IFNULL(getDefaultProductImage(14,v.BabyMonitorID),'null'),'"}',
                '],',
                '"ctgry":',getCategory(14),',',
                '"wnr":',getOwner(14,v.BrandID),',',
                '"clrs":[',IFNULL(getProductImages(14,v.BabyMonitorID),''),'],',
                IF(getProductPurchaseInfo(14,v.BabyMonitorID) IS NOT NULL,CONCAT('"mrchnts":[',getProductPurchaseInfo(14,v.BabyMonitorID),'],'),''),
                '"strs":[',IFNULL(getStrs(14,v.BabyMonitorID),''),'],',
                '"attrs":[',
                IFNULL(getProductDetailGroups('{"ky":"BabyMonitorID", "vl":"',14),'{"ky":"BabyMonitorID", "vl":"'),IFNULL(BabyMonitorID,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CategoryID", "vl":"',14),'{"ky":"CategoryID", "vl":"'),IFNULL(v.CategoryID,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"Brand", "vl":"',14),'{"ky":"Brand", "vl":"'),IFNULL(Brand,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BrandID", "vl":"',14),'{"ky":"BrandID", "vl":"'),IFNULL(BrandID,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"URLName", "vl":"',14),'{"ky":"URLName", "vl":"'),IFNULL(URLName,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"objectID", "vl":"',14),'{"ky":"objectID", "vl":"'),IFNULL(objectID,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"Manufacturer", "vl":"',14),'{"ky":"Manufacturer", "vl":"'),IFNULL(Manufacturer,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"Validated", "vl":"',14),'{"ky":"Validated", "vl":"'),IFNULL(Validated,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ProductModelName", "vl":"',14),'{"ky":"ProductModelName", "vl":"'),IFNULL(ProductModelName,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ModelNumber", "vl":"',14),'{"ky":"ModelNumber", "vl":"'),IFNULL(ModelNumber,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"MonitorType", "vl":"',14),'{"ky":"MonitorType", "vl":"'),IFNULL(MonitorType,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"MonitorTypeAudioOnly", "vl":"',14),'{"ky":"MonitorTypeAudioOnly", "vl":"'),IFNULL(MonitorTypeAudioOnly,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"MonitorTypeMovement", "vl":"',14),'{"ky":"MonitorTypeMovement", "vl":"'),IFNULL(MonitorTypeMovement,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"MonitorTypeVideo", "vl":"',14),'{"ky":"MonitorTypeVideo", "vl":"'),IFNULL(MonitorTypeVideo,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"SummaryMonitorType", "vl":"',14),'{"ky":"SummaryMonitorType", "vl":"'),IFNULL(SummaryMonitorType,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BestForAptLiving", "vl":"',14),'{"ky":"BestForAptLiving", "vl":"'),IFNULL(BestForAptLiving,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BestForLargeHome", "vl":"',14),'{"ky":"BestForLargeHome", "vl":"'),IFNULL(BestForLargeHome,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BestForMultipleChildren", "vl":"',14),'{"ky":"BestForMultipleChildren", "vl":"'),IFNULL(BestForMultipleChildren,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BestForWorkingParents", "vl":"',14),'{"ky":"BestForWorkingParents", "vl":"'),IFNULL(BestForWorkingParents,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BestForSummary", "vl":"',14),'{"ky":"BestForSummary", "vl":"'),IFNULL(BestForSummary,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"FeatureExtensiveRange", "vl":"',14),'{"ky":"FeatureExtensiveRange", "vl":"'),IFNULL(FeatureExtensiveRange,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"FeatureSecureConnection", "vl":"',14),'{"ky":"FeatureSecureConnection", "vl":"'),IFNULL(FeatureSecureConnection,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"FeatureLargeLCD", "vl":"',14),'{"ky":"FeatureLargeLCD", "vl":"'),IFNULL(FeatureLargeLCD,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"FeaturePanningZooming", "vl":"',14),'{"ky":"FeaturePanningZooming", "vl":"'),IFNULL(FeaturePanningZooming,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"FeatureMultiCameraViews", "vl":"',14),'{"ky":"FeatureMultiCameraViews", "vl":"'),IFNULL(FeatureMultiCameraViews,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"FeatureMultipleMPUs", "vl":"',14),'{"ky":"FeatureMultipleMPUs", "vl":"'),IFNULL(FeatureMultipleMPUs,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"FeatureMotionDetection", "vl":"',14),'{"ky":"FeatureMotionDetection", "vl":"'),IFNULL(FeatureMotionDetection,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"FeatureSoundActivation", "vl":"',14),'{"ky":"FeatureSoundActivation", "vl":"'),IFNULL(FeatureSoundActivation,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"FeatureLongBatteryLife", "vl":"',14),'{"ky":"FeatureLongBatteryLife", "vl":"'),IFNULL(FeatureLongBatteryLife,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"SavvyNetworkViewable", "vl":"',14),'{"ky":"SavvyNetworkViewable", "vl":"'),IFNULL(SavvyNetworkViewable,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"SavvySmartPhoneViewable", "vl":"',14),'{"ky":"SavvySmartPhoneViewable", "vl":"'),IFNULL(SavvySmartPhoneViewable,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"SavvyImageSharing", "vl":"',14),'{"ky":"SavvyImageSharing", "vl":"'),IFNULL(SavvyImageSharing,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"SavvyTouchMenu", "vl":"',14),'{"ky":"SavvyTouchMenu", "vl":"'),IFNULL(SavvyTouchMenu,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ComfortsPortable", "vl":"',14),'{"ky":"ComfortsPortable", "vl":"'),IFNULL(ComfortsPortable,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ComfortsTalkBack", "vl":"',14),'{"ky":"ComfortsTalkBack", "vl":"'),IFNULL(ComfortsTalkBack,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ComfortsColorVideo", "vl":"',14),'{"ky":"ComfortsColorVideo", "vl":"'),IFNULL(ComfortsColorVideo,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ComfortsNightVision", "vl":"',14),'{"ky":"ComfortsNightVision", "vl":"'),IFNULL(ComfortsNightVision,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ComfortsMusic", "vl":"',14),'{"ky":"ComfortsMusic", "vl":"'),IFNULL(ComfortsMusic,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ComfortsNightLight", "vl":"',14),'{"ky":"ComfortsNightLight", "vl":"'),IFNULL(ComfortsNightLight,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ComfortsTempDisplay", "vl":"',14),'{"ky":"ComfortsTempDisplay", "vl":"'),IFNULL(ComfortsTempDisplay,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"Priority", "vl":"',14),'{"ky":"Priority", "vl":"'),IFNULL(Priority,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BBBrandRating", "vl":"',14),'{"ky":"BBBrandRating", "vl":"'),IFNULL(BBBrandRating,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BBModelRecommended", "vl":"',14),'{"ky":"BBModelRecommended", "vl":"'),IFNULL(BBModelRecommended,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BabbleRecomended", "vl":"',14),'{"ky":"BabbleRecomended", "vl":"'),IFNULL(BabbleRecomended,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"GigglesListed", "vl":"',14),'{"ky":"GigglesListed", "vl":"'),IFNULL(GigglesListed,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"AvailableAmazon", "vl":"',14),'{"ky":"AvailableAmazon", "vl":"'),IFNULL(AvailableAmazon,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"AmazonURL", "vl":"',14),'{"ky":"AmazonURL", "vl":"'),IFNULL(AmazonURL,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ASIN", "vl":"',14),'{"ky":"ASIN", "vl":"'),IFNULL(ASIN,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"AmazonBestseller", "vl":"',14),'{"ky":"AmazonBestseller", "vl":"'),IFNULL(AmazonBestseller,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BabiesRUsBestseller", "vl":"',14),'{"ky":"BabiesRUsBestseller", "vl":"'),IFNULL(BabiesRUsBestseller,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BabiesRUsTopRated", "vl":"',14),'{"ky":"BabiesRUsTopRated", "vl":"'),IFNULL(BabiesRUsTopRated,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BabiesRUsRating", "vl":"',14),'{"ky":"BabiesRUsRating", "vl":"'),IFNULL(BabiesRUsRating,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"NAPPAAwardWinner", "vl":"',14),'{"ky":"NAPPAAwardWinner", "vl":"'),IFNULL(NAPPAAwardWinner,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"JPMAInnovationAwardWinner", "vl":"',14),'{"ky":"JPMAInnovationAwardWinner", "vl":"'),IFNULL(JPMAInnovationAwardWinner,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"PTPAAwardWinner", "vl":"',14),'{"ky":"PTPAAwardWinner", "vl":"'),IFNULL(PTPAAwardWinner,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"iParentingAwardWinner", "vl":"',14),'{"ky":"iParentingAwardWinner", "vl":"'),IFNULL(iParentingAwardWinner,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BrandURL", "vl":"',14),'{"ky":"BrandURL", "vl":"'),IFNULL(BrandURL,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ModelURL", "vl":"',14),'{"ky":"ModelURL", "vl":"'),IFNULL(ModelURL,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"DesignStyle", "vl":"',14),'{"ky":"DesignStyle", "vl":"'),IFNULL(DesignStyle,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BrandLevelMarketingPosition", "vl":"',14),'{"ky":"BrandLevelMarketingPosition", "vl":"'),IFNULL(BrandLevelMarketingPosition,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CollectionLevelMarketingPositon", "vl":"',14),'{"ky":"CollectionLevelMarketingPositon", "vl":"'),IFNULL(CollectionLevelMarketingPositon,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ProductOverview", "vl":"',14),'{"ky":"ProductOverview", "vl":"'),IFNULL(ProductOverview,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CountryManufacturer", "vl":"',14),'{"ky":"CountryManufacturer", "vl":"'),IFNULL(CountryManufacturer,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CRURL", "vl":"',14),'{"ky":"CRURL", "vl":"'),IFNULL(CRURL,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CRTested", "vl":"',14),'{"ky":"CRTested", "vl":"'),IFNULL(CRTested,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CROverallScore", "vl":"',14),'{"ky":"CROverallScore", "vl":"'),IFNULL(CROverallScore,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CRInterference", "vl":"',14),'{"ky":"CRInterference", "vl":"'),IFNULL(CRInterference,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CRRange", "vl":"',14),'{"ky":"CRRange", "vl":"'),IFNULL(CRRange,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CREaseOfUse", "vl":"',14),'{"ky":"CREaseOfUse", "vl":"'),IFNULL(CREaseOfUse,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CRBatteryLife", "vl":"',14),'{"ky":"CRBatteryLife", "vl":"'),IFNULL(CRBatteryLife,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CRSummary", "vl":"',14),'{"ky":"CRSummary", "vl":"'),IFNULL(CRSummary,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CRTake", "vl":"',14),'{"ky":"CRTake", "vl":"'),IFNULL(CRTake,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CRHighs", "vl":"',14),'{"ky":"CRHighs", "vl":"'),IFNULL(CRHighs,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CRLows", "vl":"',14),'{"ky":"CRLows", "vl":"'),IFNULL(CRLows,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RecallEvent", "vl":"',14),'{"ky":"RecallEvent", "vl":"'),IFNULL(RecallEvent,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RecallURL", "vl":"',14),'{"ky":"RecallURL", "vl":"'),IFNULL(RecallURL,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RecallDate", "vl":"',14),'{"ky":"RecallDate", "vl":"'),IFNULL(RecallDate,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RecallUnits", "vl":"',14),'{"ky":"RecallUnits", "vl":"'),IFNULL(RecallUnits,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RecallHazard", "vl":"',14),'{"ky":"RecallHazard", "vl":"'),IFNULL(RecallHazard,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RecallIncidentsInjuries", "vl":"',14),'{"ky":"RecallIncidentsInjuries", "vl":"'),IFNULL(RecallIncidentsInjuries,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RecallSeverity", "vl":"',14),'{"ky":"RecallSeverity", "vl":"'),IFNULL(RecallSeverity,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"Encrypted", "vl":"',14),'{"ky":"Encrypted", "vl":"'),IFNULL(Encrypted,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"NightLight", "vl":"',14),'{"ky":"NightLight", "vl":"'),IFNULL(NightLight,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"NightVision", "vl":"',14),'{"ky":"NightVision", "vl":"'),IFNULL(NightVision,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"Wireless", "vl":"',14),'{"ky":"Wireless", "vl":"'),IFNULL(Wireless,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"OffSiteViewing", "vl":"',14),'{"ky":"OffSiteViewing", "vl":"'),IFNULL(OffSiteViewing,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ConnectsComputer", "vl":"',14),'{"ky":"ConnectsComputer", "vl":"'),IFNULL(ConnectsComputer,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"TwoWay", "vl":"',14),'{"ky":"TwoWay", "vl":"'),IFNULL(TwoWay,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"LCDSize", "vl":"',14),'{"ky":"LCDSize", "vl":"'),IFNULL(LCDSize,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"Video", "vl":"',14),'{"ky":"Video", "vl":"'),IFNULL(Video,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"TouchScreenMenu", "vl":"',14),'{"ky":"TouchScreenMenu", "vl":"'),IFNULL(TouchScreenMenu,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"MotionDetector", "vl":"',14),'{"ky":"MotionDetector", "vl":"'),IFNULL(MotionDetector,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"SoundActivatedSignal", "vl":"',14),'{"ky":"SoundActivatedSignal", "vl":"'),IFNULL(SoundActivatedSignal,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"OutOfRangeIndicator", "vl":"',14),'{"ky":"OutOfRangeIndicator", "vl":"'),IFNULL(OutOfRangeIndicator,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CameraFeatures", "vl":"',14),'{"ky":"CameraFeatures", "vl":"'),IFNULL(CameraFeatures,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"MonitorDocking", "vl":"',14),'{"ky":"MonitorDocking", "vl":"'),IFNULL(MonitorDocking,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"NumberAdditionalCameras", "vl":"',14),'{"ky":"NumberAdditionalCameras", "vl":"'),IFNULL(NumberAdditionalCameras,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"Frequency", "vl":"',14),'{"ky":"Frequency", "vl":"'),IFNULL(Frequency,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"SignalRange", "vl":"',14),'{"ky":"SignalRange", "vl":"'),IFNULL(SignalRange,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"PowerType", "vl":"',14),'{"ky":"PowerType", "vl":"'),IFNULL(PowerType,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"PUPowerType", "vl":"',14),'{"ky":"PUPowerType", "vl":"'),IFNULL(PUPowerType,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RechargeableBatteryLife", "vl":"',14),'{"ky":"RechargeableBatteryLife", "vl":"'),IFNULL(RechargeableBatteryLife,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"LowBatteryIndicator", "vl":"',14),'{"ky":"LowBatteryIndicator", "vl":"'),IFNULL(LowBatteryIndicator,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"LowFeedbackMechanism", "vl":"',14),'{"ky":"LowFeedbackMechanism", "vl":"'),IFNULL(LowFeedbackMechanism,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CustomerService", "vl":"',14),'{"ky":"CustomerService", "vl":"'),IFNULL(CustomerService,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"IncludedParentUnits", "vl":"',14),'{"ky":"IncludedParentUnits", "vl":"'),IFNULL(IncludedParentUnits,'null'),'"},',
                IF(v.AdditionalParentUnitAvail IS NOT NULL,CONCAT(getProductDetailGroupsAccessories(14,'{"ky":"AdditionalParentUnitAvail", "vl":"',AdditionalParentUnitAvail),v.AdditionalParentUnitAvail,'"},'),''),
                IF(v.AdditionalMonitorsAvail IS NOT NULL,CONCAT(getProductDetailGroupsAccessories(14,'{"ky":"AdditionalMonitorsAvail", "vl":"',AdditionalMonitorsAvail),v.AdditionalMonitorsAvail,'"},'),''),
                IFNULL(getProductDetailGroups('{"ky":"SignalType", "vl":"',14),'{"ky":"SignalType", "vl":"'),IFNULL(SignalType,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"NetworkViewable", "vl":"',14),'{"ky":"NetworkViewable", "vl":"'),IFNULL(NetworkViewable,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"SmartPhoneViewable", "vl":"',14),'{"ky":"SmartPhoneViewable", "vl":"'),IFNULL(SmartPhoneViewable,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ImageSharing", "vl":"',14),'{"ky":"ImageSharing", "vl":"'),IFNULL(ImageSharing,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ExtraParentUnitPrice", "vl":"',14),'{"ky":"ExtraParentUnitPrice", "vl":"'),IFNULL(ExtraParentUnitPrice,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"Music", "vl":"',14),'{"ky":"Music", "vl":"'),IFNULL(Music,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"VolumeControl", "vl":"',14),'{"ky":"VolumeControl", "vl":"'),IFNULL(VolumeControl,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"Humidifier", "vl":"',14),'{"ky":"Humidifier", "vl":"'),IFNULL(Humidifier,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"TemperatureDisplay", "vl":"',14),'{"ky":"TemperatureDisplay", "vl":"'),IFNULL(TemperatureDisplay,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"Portability", "vl":"',14),'{"ky":"Portability", "vl":"'),IFNULL(Portability,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ListPrice", "vl":"',14),'{"ky":"ListPrice", "vl":"'),IFNULL(ListPrice,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ListPriceRange", "vl":"',14),'{"ky":"ListPriceRange", "vl":"'),IFNULL(ListPriceRange,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"SalePrice", "vl":"',14),'{"ky":"SalePrice", "vl":"'),IFNULL(SalePrice,'null'),'"},',
                getLowestPriceInfo(14,v.BabyMonitorID),',',
                IFNULL(getProductDetailGroups('{"ky":"NewModelDiscount", "vl":"',14),'{"ky":"NewModelDiscount", "vl":"'),IFNULL(NewModelDiscount,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"DiscountedModelURL", "vl":"',14),'{"ky":"DiscountedModelURL", "vl":"'),IFNULL(DiscountedModelURL,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"FacebookURL", "vl":"',14),'{"ky":"FacebookURL", "vl":"'),IFNULL(FacebookURL,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BrandFacebookLikes", "vl":"',14),'{"ky":"BrandFacebookLikes", "vl":"'),IFNULL(BrandFacebookLikes,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"TwitterName", "vl":"',14),'{"ky":"TwitterName", "vl":"'),IFNULL(TwitterName,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"TwitterURL", "vl":"',14),'{"ky":"TwitterURL", "vl":"'),IFNULL(TwitterURL,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BrandTwitterFollowers", "vl":"',14),'{"ky":"BrandTwitterFollowers", "vl":"'),IFNULL(BrandTwitterFollowers,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"YoutubeURL", "vl":"',14),'{"ky":"YoutubeURL", "vl":"'),IFNULL(YoutubeURL,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"YoutubeSubscribers", "vl":"',14),'{"ky":"YoutubeSubscribers", "vl":"'),IFNULL(YoutubeSubscribers,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"YoutubeViews", "vl":"',14),'{"ky":"YoutubeViews", "vl":"'),IFNULL(YoutubeViews,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"YoutubeChannelUploadViews", "vl":"',14),'{"ky":"YoutubeChannelUploadViews", "vl":"'),IFNULL(YoutubeChannelUploadViews,'null'),'"}],',
                '"mtvtrs" : {',
                '"A":',IFNULL(m.A,0),',',
                '"B":',IFNULL(m.B,0),',',
                '"C":',IFNULL(m.C,0),',',
                '"E":',IFNULL(m.E,0),',',
                '"F":',IFNULL(m.F,0),',',
                '"G":',IFNULL(m.G,0),',',
                '"H":',IFNULL(m.H,0),',',
                '"I":',IFNULL(m.I,0),',',
                '"J":',IFNULL(m.J,0),',',
                '"K":',IFNULL(m.K,0),',',
                '"L":',IFNULL(m.L,0),'',
                '}}'),'"null"','null')) AS payload
                FROM vw_babymonitor_data_ui v
                JOIN vw_babymonitor_motivators m
                  ON v.BabyMonitorID = m.ItemID AND
                  m.CategoryID = v.CategoryID
                WHERE getDefaultProductImage(14,v.BabyMonitorID) IS NOT NULL
                  AND getLowestPriceInfo(14,v.BabyMonitorID) IS NOT NULL
                  AND (v.IsDirty = 1 or imagesDirty(14,v.BabyMonitorID))
                GROUP BY v.BabyMonitorID
                ]]>
            </value>
        </property>
        <property name="ingestService" ref="itemService"/>
        <property name="ingestMethod" value="saveItems"/>
        <property name="jsonType" value="com.lela.domain.document.Item"/>
        <property name="batchSize" value="10"/>
        <property name="etlUpdateQuery">
            <value>
                <![CDATA[
                update babymonitor_data set objectId = '@{id}', isdirty = -1 where babymonitorid = @{tld}
                ]]>
            </value>
        </property>
    </bean>
    -->
    <!--
        CAR SEAT INGEST JOB
    -->
    <!--
    <bean id="carSeatEtlJobDetailTrigger" class="org.springframework.scheduling.quartz.CronTriggerBean">
        <property name="jobDetail" ref="carSeatEtlJobDetail"/>
        <property name="cronExpression" value="0 4 3 * * ?"/>
    </bean>
    -->
    <!--
    <bean id="carSeatEtlJobDetail" class="com.lela.commons.jobs.etl.EtlJobDetail">
        <property name="name" value="Ingest Car Seat"/>
        <property name="interceptors">
            <list>
                <ref bean="functionalFiltersIngestJobInterceptor"/>
            </list>
        </property>
        <property name="preExecutionQueries">
            <list>
                <value>call create_view_tables</value>
            </list>
        </property>
        <property name="sqlQuery">
            <value>
            <![CDATA[
            SELECT
              GROUP_CONCAT(REPLACE(CONCAT('{"nm":"',sd.ProductModelName, '",',
            '"lcl":"en_US",',
            '"tp":"PRODUCT",',
            '"tld":"',IFNULL(sd.CarSeatID,'null'),'",',
            '"rlnm":"',sd.URLName,'",',
			'"srlnm":"', ifnull(sd.LelaURL, 'null'), '",',
            IF(sd.objectID IS NOT NULL,CONCAT('"id":"',sd.objectID,'",'),'"id": null,'),
            '"sbttrs":[',
            '{"ky":"Brand", "vl":"',IFNULL(sd.Brand,'null'),'"},',
            '{"ky":"ProductModelName", "vl":"',IFNULL(sd.ProductModelName,'null'),'"},',
            '{"ky":"ListPrice", "vl":',IFNULL(CAST(REPLACE(ListPrice,'$','') AS DECIMAL(8,2)),'null'),'}, ',
            getLowestPriceInfo(12,sd.CarSeatID),',',
            '{"ky":"ProductImageUrl", "vl":"',IFNULL(getDefaultProductImage(12,sd.CarSeatID),'null'),'"}',
            '],',
            '"ctgry":',getCategory(12),',',
            '"wnr":',getOwner(12,sd.BrandID),',',
            '"clrs":[',IFNULL(getProductImages(12,sd.CarSeatID),''),'],',
            IF(getProductPurchaseInfo(12,sd.CarSeatID) IS NOT NULL,CONCAT('"mrchnts":[',getProductPurchaseInfo(12,sd.CarSeatID),'],'),''),
            '"strs":[',IFNULL(getStrs(12,sd.CarSeatID),''),'],',
            '"attrs":[',
            '{"ky":"ColorCount", "vl":"',IFNULL(getProductColorCount(12,sd.CarSeatID),'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"Manufacturer", "vl":"',12),'{"ky":"Manufacturer","vl":"'),IFNULL(sd.Manufacturer,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"ProductModelName", "vl":"',12),'{"ky":"ProductModelName", "vl":"'),IFNULL(sd.ProductModelName,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"ModelNumber", "vl":"',12),'{"ky":"ModelNumber","vl":"'),IFNULL(sd.ModelNumber,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"CarSeatType", "vl":"',12),'{"ky":"CarSeatType","vl":"'),IFNULL(sd.CarSeatType,'null'),'"},',
            '{"ky":"CarSeatTypeBestForNewborns", "vl":"',IFNULL(sd.CarSeatTypeBestForNewborns,'null'),'"},',
            '{"ky":"CarSeatTypeGrowsWithChild", "vl":"',IFNULL(sd.CarSeatTypeGrowsWithChild,'null'),'"},',
            IF(sd.SummaryCarseatType IS NOT NULL,CONCAT(getProductDetailGroups('{"ky":"SummaryCarseatType", "vl":"',12),sd.SummaryCarseatType,'"},'),''),
            '{"ky":"FeatureStrollerCompatible", "vl":"',IFNULL(sd.FeatureStrollerCompatible,'null'),'"},',
            '{"ky":"FeatureShockAbsorbingFoam", "vl":"',IFNULL(sd.FeatureShockAbsorbingFoam,'null'),'"},',
            '{"ky":"FeatureBoot", "vl":"',IFNULL(sd.FeatureBoot,'null'),'"},',
            '{"ky":"FeatureInfantHeadPillows", "vl":"',IFNULL(sd.FeatureInfantHeadPillows,'null'),'"},',
            '{"ky":"FeatureBodyCushions", "vl":"',IFNULL(sd.FeatureBodyCushions,'null'),'"},',
            '{"ky":"FeatureMachineWashableSeatCover", "vl":"',IFNULL(sd.FeatureMachineWashableSeatCover,'null'),'"},',
            '{"ky":"FeatureCanopy", "vl":"',IFNULL(sd.FeatureCanopy,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"CompatibleWithStroller", "vl":"',12),'{"ky":"CompatibleWithStroller", "vl":"'),IFNULL(sd.CompatibleWithStroller,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"DesignStyle", "vl":"',12),'{"ky":"DesignStyle", "vl":"'),IFNULL(sd.DesignStyle,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"BBBrandRating", "vl":"',12),'{"ky":"BBBrandRating", "vl":"'),IFNULL(sd.BBBrandRating,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"BBModelRecommended", "vl":"',12),'{"ky":"BBModelRecommended", "vl":"'),IFNULL(sd.BBModelRecommended,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"NHTSARated", "vl":"',12),'{"ky":"NHTSARated","vl":"'),IFNULL(sd.NHTSARated,'null'),'"},',
            IF(LENGTH(sd.SafetyCertification) <> 0,CONCAT(getProductDetailGroups('{"ky":"SafetyCertification", "vl":"',12),sd.SafetyCertification,'"},'),''),
            IFNULL(getProductDetailGroups('{"ky":"NHTSAConvertibleTypeRating", "vl":"',12),'{"ky":"NHTSAConvertibleTypeRating", "vl":"'),IFNULL(sd.NHTSAConvertibleTypeRating,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"NHTSALabels", "vl":"',12),'{"ky":"NHTSALabels","vl":"'),IFNULL(sd.NHTSALabels,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"NHTSAInstructions", "vl":"',12),'{"ky":"NHTSAInstructions", "vl":"'),IFNULL(sd.NHTSAInstructions,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"NHTSASecuringTheChild", "vl":"',12),'{"ky":"NHTSASecuringTheChild", "vl":"'),IFNULL(sd.NHTSASecuringTheChild,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"NHTSAInstallationFeatures", "vl":"',12),'{"ky":"NHTSAInstallationFeatures", "vl":"'),IFNULL(sd.NHTSAInstallationFeatures,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"NHSTAOverallEaseOfUse", "vl":"',12),'{"ky":"NHSTAOverallEaseOfUse", "vl":"'),IFNULL(sd.NHSTAOverallEaseOfUse,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"BabbleRecomended", "vl":"',12),'{"ky":"BabbleRecomended", "vl":"'),IFNULL(sd.BabbleRecomended,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"GigglesListed", "vl":"',12),'{"ky":"GigglesListed", "vl":"'),IFNULL(sd.GigglesListed,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"AmazonBestseller", "vl":"',12),'{"ky":"AmazonBestseller", "vl":"'),IFNULL(sd.AmazonBestseller,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"AmazonRating", "vl":"',12),'{"ky":"AmazonRating","vl":"'),IFNULL(sd.AmazonRating,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"BabiesRUsBestseller", "vl":"',12),'{"ky":"BabiesRUsBestseller", "vl":"'),IFNULL(sd.BabiesRUsBestseller,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"BabiesRUsTopRated", "vl":"',12),'{"ky":"BabiesRUsTopRated", "vl":"'),IFNULL(sd.BabiesRUsTopRated,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"NAPPAAwardWinner", "vl":"',12),'{"ky":"NAPPAAwardWinner", "vl":"'),IFNULL(sd.NAPPAAwardWinner,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"JPMAAwardWinner", "vl":"',12),'{"ky":"JPMAAwardWinner", "vl":"'),IFNULL(sd.JPMAAwardWinner,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"PTPAAwardWinner", "vl":"',12),'{"ky":"PTPAAwardWinner", "vl":"'),IFNULL(sd.PTPAAwardWinner,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"iParentingAwardWinner", "vl":"',12),'{"ky":"iParentingAwardWinner", "vl":"'),IFNULL(sd.iParentingAwardWinner,'null'),'"},',
            IF(LENGTH(sd.Awards) <> 0,CONCAT(getProductDetailGroups('{"ky":"Awards", "vl":"',12),sd.Awards,'"},'),''),
            IFNULL(getProductDetailGroups('{"ky":"BrandPromise", "vl":"',12),'{"ky":"BrandPromise","vl":"'),IFNULL(REPLACE(sd.BrandPromise,'"',''),'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"ModelPromise", "vl":"',12),'{"ky":"ModelPromise","vl":"'),IFNULL(REPLACE(sd.ModelPromise,'"',''),'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"ProductOverview", "vl":"',12),'{"ky":"ProductOverview", "vl":"'),IFNULL(REPLACE(sd.ProductOverview,'"',''),'null'),'"}, ',
            IFNULL(getProductDetailGroups('{"ky":"AvailableAmazon", "vl":"',12),'{"ky":"AvailableAmazon", "vl":"'),IFNULL(sd.AvailableAmazon,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"ASIN", "vl":"',12),'{"ky":"ASIN", "vl":"'),IFNULL(sd.ASIN,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"CountryOfManufacturer", "vl":"',12),'{"ky":"CountryOfManufacturer", "vl":"'),IFNULL(sd.CountryOfManufacturer,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"ShockAbsorbingFoam", "vl":"',12),'{"ky":"ShockAbsorbingFoam", "vl":"'),IFNULL(sd.ShockAbsorbingFoam,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"HarnessType", "vl":"',12),'{"ky":"HarnessType","vl":"'),IFNULL(sd.HarnessType,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"CRURL", "vl":"',12),'{"ky":"CRURL", "vl":"'),IFNULL(sd.CRURL,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"CRTested", "vl":"',12),'{"ky":"CRTested","vl":"'),IFNULL(sd.CRTested,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"CROverallScore", "vl":"',12),'{"ky":"CROverallScore", "vl":"'),IFNULL(sd.CROverallScore,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"CRCrashProtection", "vl":"',12),'{"ky":"CRCrashProtection", "vl":"'),IFNULL(sd.CRCrashProtection,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"CREaseOfUse", "vl":"',12),'{"ky":"CREaseOfUse","vl":"'),IFNULL(sd.CREaseOfUse,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"CRLATCH", "vl":"',12),'{"ky":"CRLATCH", "vl":"'),IFNULL(sd.CRLATCH,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"CRBELT", "vl":"',12),'{"ky":"CRBELT", "vl":"'), IFNULL(sd.CRBELT,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"CRComments", "vl":"',12),'{"ky":"CRComments","vl":"'),IFNULL(REPLACE(sd.CRComments,'"',''),'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"CRSummary", "vl":"',12),'{"ky":"CRSummary","vl":"'),IFNULL(REPLACE(sd.CRSummary,'"',''),'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"CRPROS", "vl":"',12),'{"ky":"CRPROS", "vl":"'),IFNULL(REPLACE(sd.CRPROS,'"',''),'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"CRCONS", "vl":"',12),'{"ky":"CRCONS", "vl":"'),IFNULL(REPLACE(sd.CRCONS,'"',''),'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"RecallEvent", "vl":"',12),'{"ky":"RecallEvent","vl":"'),IFNULL(sd.RecallEvent,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"RecallURL", "vl":"',12),'{"ky":"RecallURL","vl":"'),IFNULL(sd.RecallURL,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"RecallDate", "vl":"',12),'{"ky":"RecallDate","vl":"'),IFNULL(sd.RecallDate,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"RecallUnits", "vl":"',12),'{"ky":"RecallUnits","vl":"'),IFNULL(sd.RecallUnits,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"RecallHazard", "vl":"',12),'{"ky":"RecallHazard","vl":"'),IFNULL(sd.RecallHazard,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"RecallIncidentsInjuries", "vl":"',12),'{"ky":"RecallIncidentsInjuries", "vl":"'),IFNULL(sd.RecallIncidentsInjuries,'null'),'"}, ',
            IFNULL(getProductDetailGroups('{"ky":"RecallSeverity", "vl":"',12),'{"ky":"RecallSeverity", "vl":"'),IFNULL(sd.RecallSeverity,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"NumberOfColorsNeon", "vl":"',12),'{"ky":"NumberOfColorsNeon", "vl":"'),IFNULL(sd.NumberOfColorsNeon,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"NumberOfColorsVeryBrightOrPrimary", "vl":"',12),'{"ky":"NumberOfColorsVeryBrightOrPrimary", "vl":"'),IFNULL(sd.NumberOfColorsVeryBrightOrPrimary,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"NumberOfColorsNeutralEarthTones", "vl":"',12),'{"ky":"NumberOfColorsNeutralEarthTones", "vl":"'),IFNULL(sd.NumberOfColorsNeutralEarthTones,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"NumberOfColorsDeepBluePurples", "vl":"',12),'{"ky":"NumberOfColorsDeepBluePurples", "vl":"'),IFNULL(sd.NumberOfColorsDeepBluePurples,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"NumberOfColorsGrayOrBlack", "vl":"',12),'{"ky":"NumberOfColorsGrayOrBlack", "vl":"'),IFNULL(sd.NumberOfColorsGrayOrBlack,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"TotalColors", "vl":"',12),'{"ky":"TotalColors","vl":"'),IFNULL(sd.TotalColors,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"ManufacturerColorNames", "vl":"',12),'{"ky":"ManufacturerColorNames", "vl":"'),IFNULL(sd.ManufacturerColorNames,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"CarSeat_W", "vl":"',12),'{"ky":"CarSeat_W","vl":"'),IFNULL(sd.CarSeat_W,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"CarSeat_L", "vl":"',12),'{"ky":"CarSeat_L","vl":"'),IFNULL(sd.CarSeat_L,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"CarSeat_H", "vl":"',12),'{"ky":"CarSeat_H","vl":"'),IFNULL(sd.CarSeat_H,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"DimensionsInches_WLH", "vl":"',12),'{"ky":"DimensionsInches_WLH", "vl":"'),IFNULL(sd.DimensionsInches_WLH,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"CarrierWeight", "vl":"',12),'{"ky":"CarrierWeight", "vl":"'),IFNULL(sd.CarrierWeight,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"ChildWeightLimit", "vl":"',12),'{"ky":"ChildWeightLimit", "vl":"'),IFNULL(sd.ChildWeightLimit,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"ChildHeightLimit", "vl":"',12),'{"ky":"ChildHeightLimit", "vl":"'),IFNULL(sd.ChildHeightLimit,'null'),'"},',
            IF(Boot IS NOT NULL,CONCAT(getProductDetailGroupsAccessories(12,'{"ky":"Boot", "vl":"', Boot),BootAcc,'"},'),''),
            IFNULL(getProductDetailGroups('{"ky":"PlushPadding", "vl":"',12),'{"ky":"PlushPadding","vl":"'),IFNULL(sd.PlushPadding,'null'),'"},',
            IF(InfantHeadPillows IS NOT NULL,CONCAT(getProductDetailGroupsAccessories(12,'{"ky":"InfantHeadPillows", "vl":"',InfantHeadPillows),InfantHeadPillowsAcc,'"},'),''),
            IF(BodyCushions IS NOT NULL,CONCAT(getProductDetailGroupsAccessories(12,'{"ky":"BodyCushions","vl":"',BodyCushions),BodyCushionsAcc,'"},'),''),
            IFNULL(getProductDetailGroups('{"ky":"BreathableFabrics", "vl":"',12),'{"ky":"BreathableFabrics", "vl":"'),IFNULL(sd.BreathableFabrics,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"MachineWashableFabrics", "vl":"',12),'{"ky":"MachineWashableFabrics", "vl":"'),IFNULL(sd.MachineWashableFabrics,'null'),'"},',
            IF(Canopy IS NOT NULL,CONCAT(getProductDetailGroupsAccessories(12,'{"ky":"Canopy", "vl":"',Canopy),CanopyAcc,'"},'),''),
            '{"ky":"ListPrice", "vl":',IFNULL(CAST(REPLACE(sd.ListPrice,'$','') AS DECIMAL(8,2)),'null'), '},',
            getLowestPriceInfo(12,sd.CarSeatID),',',
            IFNULL(getProductDetailGroups('{"ky":"ListPriceRange", "vl":"',12),'{"ky":"ListPriceRange", "vl":"'),IFNULL(sd.ListPriceRange,'null'),'"},',
            '{"ky":"SalePrice", "vl":',IFNULL(CAST(REPLACE(sd.SalePrice,'$','') AS DECIMAL(8,2)),'null'),'},',
            IFNULL(getProductDetailGroups('{"ky":"NewModelDiscount", "vl":"',12),'{"ky":"NewModelDiscount", "vl":"'),IFNULL(sd.NewModelDiscount,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"DiscountedModelSourceURL", "vl":"',12),'{"ky":"DiscountedModelSourceURL", "vl":"'),IFNULL(sd.DiscountedModelSourceURL,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"FacebookURL", "vl":"',12),'{"ky":"FacebookURL","vl":"'),IFNULL(sd.FacebookURL,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"BrandFacebookLikes", "vl":"',12),'{"ky":"BrandFacebookLikes", "vl":"'),IFNULL(sd.FacebookLikes,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"TwitterName", "vl":"',12),'{"ky":"TwitterName","vl":"'),IFNULL(sd.TwitterName,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"TwitterURL", "vl":"',12),'{"ky":"TwitterURL","vl":"'),IFNULL(sd.TwitterURL,'null'),'"},',
            IFNULL(getProductDetailGroups('{"ky":"BrandTwitterFollowers", "vl":"',12),'{"ky":"BrandTwitterFollowers", "vl":"'),IFNULL(sd.TwitterFollowers,'null'),'"}],',
            '"mtvtrs" : {',
            '"A":',IFNULL(m.A,0),',',
            '"B":',IFNULL(m.B,0),',',
            '"C":',IFNULL(m.C,0),',',
            '"E":',IFNULL(m.E,0),',',
            '"F":',IFNULL(m.F,0),',',
            '"G":',IFNULL(m.G,0),',',
            '"H":',IFNULL(m.H,0),',',
            '"I":',IFNULL(m.I,0),',',
            '"J":',IFNULL(m.J,0),',',
            '"K":',IFNULL(m.K,0),',',
            '"L":',IFNULL(m.L,0),'',
            '}}'),'"null"','null')) AS payload
            FROM vw_carseat_data_ui sd
            JOIN vw_carseat_motivators m
              ON sd.CarseatID = m.ItemID AND
              m.CategoryID = sd.CategoryID
            WHERE getDefaultProductImage(12,sd.CarSeatID) IS NOT NULL
            AND getLowestPriceInfo(12,sd.CarSeatID) IS NOT NULL
            AND (sd.IsDirty = 1 or imagesDirty(12,sd.CarSeatID) = 1)
            GROUP BY sd.CarseatID
            ]]>
            </value>
        </property>
        <property name="ingestService" ref="itemService"/>
        <property name="ingestMethod" value="saveItems"/>
        <property name="jsonType" value="com.lela.domain.document.Item"/>
        <property name="batchSize" value="10"/>
        <property name="etlUpdateQuery">
            <value>
                <![CDATA[
                update carseat_data set objectId = '@{id}', isdirty = -1 where carseatid = @{tld}
                ]]>
            </value>
        </property>
    </bean>
    -->
    <!--
        CRIB INGEST JOB
    -->
    <!--
    <bean id="cribEtlJobDetailTrigger" class="org.springframework.scheduling.quartz.CronTriggerBean">
        <property name="jobDetail" ref="cribEtlJobDetail"/>
        <property name="cronExpression" value="0 5 3 * * ?"/>
    </bean>
    -->
    <!--
    <bean id="cribEtlJobDetail" class="com.lela.commons.jobs.etl.EtlJobDetail">
        <property name="name" value="Ingest Crib"/>
        <property name="interceptors">
            <list>
                <ref bean="functionalFiltersIngestJobInterceptor"/>
            </list>
        </property>
        <property name="preExecutionQueries">
            <list>
                <value>call create_view_tables</value>
            </list>
        </property>
        <property name="sqlQuery">
            <value>
                <![CDATA[
                SELECT
                GROUP_CONCAT(
                REPLACE(
                CONCAT(
                '{"nm":"',v.ProductModelName,'",',
                '"lcl":"en_US",',
                '"tp":"PRODUCT",',
                '"tld":"',IFNULL(v.CribID,'null'),'",',
                '"rlnm":"',v.URLName,'",',
				'"srlnm":"', ifnull(v.LelaURL, 'null'), '",',
                IF(v.objectID IS NOT NULL,CONCAT('"id":"',v.objectID,'",'),'"id": null,'),
                '"sbttrs":[',
                '{"ky":"Brand", "vl":"',IFNULL(v.Brand,'null'),'"},',
                '{"ky":"ProductModelName", "vl":"',IFNULL(v.ProductModelName,'null'),'"},',
                '{"ky":"ListPrice", "vl":',IFNULL(v.ListPrice,0.00),'},',
                getLowestPriceInfo(11,v.CribID),',',
                '{"ky":"ProductImageUrl", "vl":"',IFNULL(getDefaultProductImage(11,v.CribID),'null'),'"}',
                '],',
                '"ctgry":',getCategory(11),',',
                '"wnr":',getOwner(11,v.BrandID),',',
                '"clrs":[',IFNULL(getProductImages(11,v.CribID),''),'],',
                IF(getProductPurchaseInfo(11,v.CribID) IS NOT NULL,CONCAT('"mrchnts":[',getProductPurchaseInfo(11,v.CribID),'],'),''),
                '"strs":[',IFNULL(getStrs(11,v.CribID),''),'],',
                '"attrs":[',
                '{"ky":"ColorCount", "vl":"',IFNULL(getProductColorCount(11,v.CribID),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"Manufacturer", "vl":"',11),'{"ky":"Manufacturer", "vl":"'),IFNULL(v.Manufacturer,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ProductModelName", "vl":"',11),'{"ky":"ProductModelName", "vl":"'),IFNULL(v.ProductModelName,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ModelNumber", "vl":"',11),'{"ky":"ModelNumber","vl":"'),IFNULL(v.ModelNumber,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ProductImageUrl", "vl":"',11),'{"ky":"ProductImageUrl", "vl":"'),IFNULL(getDefaultProductImage(11,v.CribID),'null'),'"}, ',
                '{"ky":"CribTypeStandard", "vl":"',IFNULL(v.CribTypeStandard,'null'),'"},',
                '{"ky":"CribTypePortable", "vl":"',IFNULL(v.CribTypePortable,'null'),'"},',
                '{"ky":"CribTypeTravel", "vl":"',IFNULL(v.CribTypeTravel,'null'),'"},',
                '{"ky":"CribTypeSpaceSaver", "vl":"',IFNULL(v.CribTypeSpaceSaver,'null'),'"},',
                '{"ky":"CribTypeMultifunctional", "vl":"',IFNULL(v.CribTypeMultifunctional,'null'),'"},',
                '{"ky":"CribTypeGrowsWithChild", "vl":"',IFNULL(v.CribTypeGrowsWithChild,'null'),'"},',
                IF(v.SummaryCribType IS NOT NULL,CONCAT(getProductDetailGroups('{"ky":"SummaryCribType","vl":"',11),v.SummaryCribType,'"},'),''),
                '{"ky":"DesignStyleTraditional", "vl":"',IFNULL(v.DesignStyleTraditional,'null'),'"},',
                '{"ky":"DesignStyleModern", "vl":"',IFNULL(v.DesignStyleModern,'null'),'"},',
                '{"ky":"DesignStyleVintage", "vl":"',IFNULL(v.DesignStyleVintage,'null'),'"},',
                '{"ky":"DesignStyleWhimsical", "vl":"',IFNULL(v.DesignStyleWhimsical,'null'),'"},',
                '{"ky":"DesignStyleLuxury", "vl":"',IFNULL(v.DesignStyleLuxury,'null'),'"},',
                '{"ky":"PrefAllWoodConstruction", "vl":"',IFNULL(v.PrefAllWoodConstruction,'null'),'"},',
                '{"ky":"PrefIronOtherMetals", "vl":"',IFNULL(v.PrefIronOtherMetals,'null'),'"},',
                '{"ky":"PrefContemporaryMetals", "vl":"',IFNULL(v.PrefContemporaryMetals,'null'),'"},',
                '{"ky":"PrefECOFriendly", "vl":"',IFNULL(v.PrefECOFriendly,'null'),'"},',
                '{"ky":"PrefSleigh", "vl":"',IFNULL(v.PrefSleigh,'null'),'"},',
                '{"ky":"PrefMission", "vl":"',IFNULL(v.PrefMission,'null'),'"},',
                '{"ky":"PrefJennyLind", "vl":"',IFNULL(v.PrefJennyLind,'null'),'"},',
                '{"ky":"PrefCanopy", "vl":"',IFNULL(v.PrefCanopy,'null'),'"},',
                '{"ky":"PrefRaisedEnds", "vl":"',IFNULL(v.PrefRaisedEnds,'null'),'"},',
                '{"ky":"PrefCastors", "vl":"',IFNULL(v.PrefCastors,'null'),'"},',
                '{"ky":"ColorWhite", "vl":"',IFNULL(v.ColorWhite,'null'),'"},',
                '{"ky":"ColorDarkBrown", "vl":"',IFNULL(v.ColorDarkBrown,'null'),'"},',
                '{"ky":"ColorLightBrown", "vl":"',IFNULL(v.ColorLightBrown,'null'),'"},',
                '{"ky":"ColorNatural", "vl":"',IFNULL(v.ColorNatural,'null'),'"},',
                '{"ky":"ColorOtherColor", "vl":"',IFNULL(v.ColorOtherColor,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ProductOverview", "vl":"',11),'{"ky":"ProductOverview", "vl":"'),IFNULL(REPLACE(REPLACE(v.ProductOverview,'     ',''), '"', 'inch'),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BBBrandRating", "vl":"',11),'{"ky":"BBBrandRating", "vl":"'),IFNULL(v.BBBrandRating,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BBModelRecommended", "vl":"',11),'{"ky":"BBModelRecommended", "vl":"'),IFNULL(v.BBModelRecommended,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"GigglesListed", "vl":"',11),'{"ky":"GigglesListed", "vl":"'),IFNULL(v.GigglesListed,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BrandCelebrityOwned", "vl":"',11),'{"ky":"BrandCelebrityOwned", "vl":"'),IFNULL(v.BrandCelebrityOwned,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BrandPromise", "vl":"',11),'{"ky":"BrandPromise", "vl":"'),IFNULL(v.BrandPromise,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CollectionOrModelPromise", "vl":"',11),'{"ky":"CollectionOrModelPromise", "vl":"'),IFNULL(v.CollectionOrModelPromise,'null'),'"}, ',
                IFNULL(getProductDetailGroups('{"ky":"DesignStyle", "vl":"',11),'{"ky":"DesignStyle", "vl":"'),IFNULL(v.DesignStyle,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"SoldExclusivelyAt", "vl":"',11),'{"ky":"SoldExclusivelyAt", "vl":"'),IFNULL(v.SoldExclusivelyAt,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"OtherRetailOutlets", "vl":"',11),'{"ky":"OtherRetailOutlets", "vl":"'),IFNULL(v.OtherRetailOutlets,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"AvailableAmazon", "vl":"',11),'{"ky":"AvailableAmazon", "vl":"'),IFNULL(v.AvailableAmazon,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ASIN", "vl":"',11),'{"ky":"ASIN", "vl":"'),IFNULL(ASIN,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CountryOfManufacturer", "vl":"',11),'{"ky":"CountryOfManufacturer", "vl":"'),IFNULL(v.CountryOfManufacturer,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"JPMACertified", "vl":"',11),'{"ky":"JPMACertified", "vl":"'),IFNULL(v.JPMACertified,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CSPIACompiance", "vl":"',11),'{"ky":"CSPIACompiance", "vl":"'),IFNULL(v.CSPIACompiance,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CPSC1219_1220", "vl":"',11),'{"ky":"CPSC1219_1220", "vl":"'),IFNULL(v.CPSC1219_1220,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CPSC1130Reg", "vl":"',11),'{"ky":"CPSC1130Reg", "vl":"'),IFNULL(v.CPSC1130Reg,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CPSC1303LeadTest", "vl":"',11), '{"ky":"CPSC1303LeadTest", "vl":"'),IFNULL(v.CPSC1303LeadTest,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ASTMCert", "vl":"',11),'{"ky":"ASTMCert", "vl":"'),IFNULL(v.ASTMCert,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"FSCCert", "vl":"',11),'{"ky":"FSCCert", "vl":"'),IFNULL(v.FSCCert,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"SORCert", "vl":"',11),'{"ky":"SORCert", "vl":"'),IFNULL(v.SORCert,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CHPACompliance", "vl":"',11),'{"ky":"CHPACompliance", "vl":"'),IFNULL(v.CHPACompliance,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"GreenguardCert", "vl":"',11),'{"ky":"GreenguardCert", "vl":"'),IFNULL(v.GreenguardCert,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"SafetyCertification", "vl":"',11),'{"ky":"SafetyCertification", "vl":"'),IFNULL(v.SafetyCertification,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CRTested", "vl":"',11),'{"ky":"CRTested", "vl":"'),IFNULL(v.CRTested,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CROverallScore", "vl":"',11),'{"ky":"CROverallScore", "vl":"'),IFNULL(v.CROverallScore,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CRSafety", "vl":"',11),'{"ky":"CRSafety","vl":"'),IFNULL(v.CRSafety,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CRConstruction", "vl":"',11),'{"ky":"CRConstruction", "vl":"'),IFNULL(v.CRConstruction,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CREaseOfUse", "vl":"',11),'{"ky":"CREaseOfUse","vl":"'),IFNULL(v.CREaseOfUse,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CRComments", "vl":"',11),'{"ky":"CRComments","vl":"'),IFNULL(v.CRComments,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CRSummary", "vl":"',11),'{"ky":"CRSummary","vl":"'),IFNULL(v.CRSummary,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CRPROS", "vl":"',11),'{"ky":"CRPROS", "vl":"'),IFNULL(v.CRPROS,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CRCONS", "vl":"',11),'{"ky":"CRCONS", "vl":"'), IFNULL(CRCONS,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RecallEvent", "vl":"',11),'{"ky":"RecallEvent","vl":"'),IFNULL(RecallEvent,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RecallURL", "vl":"',11),'{"ky":"RecallURL","vl":"'),IFNULL(RecallURL,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RecallDate", "vl":"',11),'{"ky":"RecallDate","vl":"'),IFNULL(RecallDate,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RecallUnits", "vl":"',11),'{"ky":"RecallUnits","vl":"'),IFNULL(RecallUnits,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RecallHazard", "vl":"',11),'{"ky":"RecallHazard","vl":"'),IFNULL(RecallHazard,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RecallIncidents", "vl":"',11),'{"ky":"RecallIncidents", "vl":"'),IFNULL(RecallIncidents,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RecallSeverity", "vl":"',11),'{"ky":"RecallSeverity", "vl":"'),IFNULL(RecallSeverity,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"StationarySides", "vl":"',11),'{"ky":"StationarySides", "vl":"'),IFNULL(StationarySides,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"TeethingRail", "vl":"',11),'{"ky":"TeethingRail","vl":"'),IFNULL(TeethingRail,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"FinishLowToxicity", "vl":"',11),'{"ky":"FinishLowToxicity", "vl":"'),IFNULL(FinishLowToxicity,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"Portable", "vl":"',11),'{"ky":"Portable","vl":"'),IFNULL(Portable,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"Canopy", "vl":"',11),'{"ky":"Canopy", "vl":"'),IFNULL(Canopy,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"HeadAndFootBoards", "vl":"',11),'{"ky":"HeadAndFootBoards", "vl":"'),IFNULL(HeadAndFootBoards,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"MattressSupport", "vl":"',11),'{"ky":"MattressSupport", "vl":"'),IFNULL(MattressSupport,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"AdjustableMattressHeight", "vl":"',11),'{"ky":"AdjustableMattressHeight", "vl":"'),IFNULL(AdjustableMattressHeight,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ColorsAllWhite", "vl":"',11),'{"ky":"ColorsAllWhite", "vl":"'),IFNULL(ColorsAllWhite,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ColorsDarkBrown", "vl":"',11),'{"ky":"ColorsDarkBrown", "vl":"'),IFNULL(ColorsDarkBrown,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ColorsMediumBrown", "vl":"',11),'{"ky":"ColorsMediumBrown", "vl":"'),IFNULL(ColorsMediumBrown,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ColorsLightBrown", "vl":"',11),'{"ky":"ColorsLightBrown", "vl":"'),IFNULL(ColorsLightBrown,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ColorsTan", "vl":"',11),'{"ky":"ColorsTan", "vl":"'),IFNULL(ColorsTan,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ColorsOther", "vl":"',11),'{"ky":"ColorsOther","vl":"'),IFNULL(ColorsOther,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"TotalColors", "vl":"',11),'{"ky":"TotalColors", "vl":"'),IFNULL(TotalColors,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ManufacturerColors", "vl":"',11),'{"ky":"ManufacturerColors", "vl":"'),IFNULL(ManufacturerColors,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"DimensionsInches_W", "vl":"',11),'{"ky":"DimensionsInches_W", "vl":"'),IFNULL(DimensionsInches_W,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"DimensionsInches_L", "vl":"',11),'{"ky":"DimensionsInches_L", "vl":"'),IFNULL(DimensionsInches_L,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"DimensionsInches_H", "vl":"',11),'{"ky":"DimensionsInches_H", "vl":"'),IFNULL(DimensionsInches_H,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"DimensionsInches_WLH", "vl":"',11),'{"ky":"DimensionsInches_WLH", "vl":"'),IFNULL(v.DimensionsInches_WLH,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CribShape", "vl":"',11),'{"ky":"CribShape", "vl":"'),IFNULL(CribShape,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CribCapacity", "vl":"',11),'{"ky":"CribCapacity","vl":"'),IFNULL(CribCapacity,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CompactFold", "vl":"',11),'{"ky":"CompactFold","vl":"'),IFNULL(CompactFold,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"WoodType", "vl":"',11),'{"ky":"WoodType","vl":"'),IFNULL(WoodType,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"MaterialsType", "vl":"',11),'{"ky":"MaterialsType", "vl":"'),IFNULL(MaterialsType,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"AssemblyLevel", "vl":"',11),'{"ky":"AssemblyLevel", "vl":"'),IFNULL(AssemblyLevel,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CribDesignStyle", "vl":"',11),'{"ky":"CribDesignStyle", "vl":"'),IFNULL(CribDesignStyle,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"GrowsWithChild", "vl":"',11),'{"ky":"GrowsWithChild", "vl":"'),IFNULL(GrowsWithChild,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ConversionType", "vl":"',11),'{"ky":"ConversionType", "vl":"'),IFNULL(ConversionType,'null'),'"},',
                IF(BassinetIncluded IS NOT NULL,CONCAT(getProductDetailGroupsAccessories(11,'{"ky":"BassinetIncluded", "vl":"',BassinetIncluded),BassinetIncludedAcc,'"},'),''),
                IF(ChangingTableIncluded IS NOT NULL,CONCAT(getProductDetailGroupsAccessories(11,'{"ky":"ChangingTableIncluded", "vl":"',ChangingTableIncluded),ChangingTableIncludedAcc,'"}, '),''),
                IF(StorageIncluded IS NOT NULL,CONCAT(getProductDetailGroupsAccessories(11, '{"ky":"StorageIncluded", "vl":"',StorageIncluded),StorageIncludedAcc,'"},'),''),
                IF(MattressIncluded IS NOT NULL,CONCAT(getProductDetailGroupsAccessories(11, '{"ky":"MattressIncluded", "vl":"',MattressIncluded),MattressIncludedAcc,'"},'),''),
                IFNULL(getProductDetailGroups('{"ky":"HardwareVisible", "vl":"',11), '{"ky":"HardwareVisible", "vl":"'),IFNULL(HardwareVisible,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"AgeLimit", "vl":"',11),'{"ky":"AgeLimit",  "vl":"'),IFNULL(AgeLimit,'null'),'"},',
                '{"ky":"ListPrice", "vl":',IFNULL(v.ListPrice,0.00),'},',
                getLowestPriceInfo(11,v.CribID),',',
                IFNULL(getProductDetailGroups('{"ky":"ListPriceRange", "vl":"',11),'{"ky":"ListPriceRange", "vl":"'),IFNULL(ListPriceRange,'null'),'"},',
                '{"ky":"SalePrice", "vl":',IFNULL(SalePrice,'null'),'},',
                IFNULL(getProductDetailGroups('{"ky":"NewModelDiscount", "vl":"',11),'{"ky":"NewModelDiscount", "vl":"'),IFNULL(NewModelDiscount,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"SourceURLDiscountedModel", "vl":"',11),'{"ky":"SourceURLDiscountedModel", "vl":"'),IFNULL(SourceURLDiscountedModel,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ToddlerConversionPrice", "vl":"',11), '{"ky":"ToddlerConversionPrice", "vl":"'),IFNULL(ToddlerConversionPrice,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"TwinBedConversionPrice", "vl":"',11), '{"ky":"TwinBedConversionPrice", "vl":"'),IFNULL(TwinBedConversionPrice,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"FullBedConversionPrice", "vl":"',11), '{"ky":"FullBedConversionPrice", "vl":"'),IFNULL(FullBedConversionPrice,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"FacebookURL", "vl":"',11),'{"ky":"FacebookURL","vl":"'),IFNULL(v.FacebookURL,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BrandFacebookLikes", "vl":"',11),'{"ky":"BrandFacebookLikes", "vl":"'),IFNULL(v.BrandFacebookLikes,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"TwitterName", "vl":"',11),'{"ky":"TwitterName","vl":"'),IFNULL(v.TwitterName,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"TwitterURL", "vl":"',11),'{"ky":"TwitterURL","vl":"'),IFNULL(v.TwitterURL,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BrandTwitterFollowers", "vl":"',11),'{"ky":"BrandTwitterFollowers", "vl":"'),IFNULL(v.BrandTwitterFollowers,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ResaleValue", "vl":"',11),'{"ky":"ResaleValue","vl":"'),IFNULL(v.ResaleValue,'null'),'"}],','"mtvtrs" : {',
                '"A":',IFNULL(m.A,0),',',
                '"B":',IFNULL(m.B,0),',',
                '"C":',IFNULL(m.C,0),',',
                '"E":',IFNULL(m.E,0),',',
                '"G":',IFNULL(m.G,0),',',
                '"H":',IFNULL(m.H,0),',',
                '"I":',IFNULL(m.I,0),',',
                '"J":',IFNULL(m.J,0),',',
                '"K":',IFNULL(m.K,0),',',
                '"L":',IFNULL(m.L,0),'',
                '}}'),'"null"','null')) AS payload
                FROM
                  vw_cribs_data_ui v
                JOIN vw_crib_motivators m
                  ON v.CribID = m.ItemID AND
                  m.CategoryID = v.CategoryID
                WHERE (getDefaultProductImage(11,v.CribID) IS NOT NULL)
                AND (getLowestPriceInfo(11,v.CribID) IS NOT NULL)
                AND ((v.IsDirty = 1 OR imagesDirty(11,v.CribID) = 1))
                GROUP BY v.CribID
                ]]>
            </value>
        </property>
        <property name="ingestService" ref="itemService"/>
        <property name="ingestMethod" value="saveItems"/>
        <property name="jsonType" value="com.lela.domain.document.Item"/>
        <property name="batchSize" value="10"/>
        <property name="etlUpdateQuery">
            <value>
                <![CDATA[
                update cribs_data set objectId = '@{id}', isdirty = -1 where cribid = @{tld}
                ]]>
            </value>
        </property>
    </bean>
    -->
    <!--
        STROLLER INGEST JOB
    -->
    <!--
    <bean id="strollerEtlJobDetailTrigger" class="org.springframework.scheduling.quartz.CronTriggerBean">
        <property name="jobDetail" ref="strollerEtlJobDetail"/>
        <property name="cronExpression" value="0 6 3 * * ?"/>
    </bean>
    -->
    <!--
    <bean id="strollerEtlJobDetail" class="com.lela.commons.jobs.etl.EtlJobDetail">
        <property name="name" value="Ingest Stroller"/>
        <property name="interceptors">
            <list>
                <ref bean="functionalFiltersIngestJobInterceptor"/>
            </list>
        </property>
        <property name="preExecutionQueries">
            <list>
                <value>call create_view_tables</value>
            </list>
        </property>

        <property name="sqlQuery">
            <value>
                <![CDATA[
                SELECT
                  GROUP_CONCAT(REPLACE(CONCAT('{"nm":"',v.ProductModelName, '",',
                '"lcl":"en_US",',
                '"tp":"PRODUCT",',
                '"tld":"',IFNULL(v.StrollerID,'null'),'",',
                '"rlnm":"',v.URLName,'",',
				        '"srlnm":"', ifnull(v.LelaURL, 'null'), '",',
                IF(v.objectID IS NOT NULL,CONCAT('"id":"',v.objectID,'",'),'"id": null,'),
                '"sbttrs":[',
                '{"ky":"Brand", "vl":"',IFNULL(v.Brand,'null'),'"},',
                '{"ky":"ProductModelName", "vl":"',IFNULL(v.ProductModelName,'null'),'"},',
                '{"ky":"ListPrice", "vl":',IFNULL(v.ListPrice,0.00),'},',
                getLowestPriceInfo(2,v.StrollerID),',',
                '{"ky":"ProductImageUrl", "vl":"',IFNULL(getDefaultProductImage(2,v.StrollerID),'null'),'"}',
                '],',
                '"ctgry":',getCategory(2),',',
                '"wnr":',getOwner(2,v.BrandID),',',
                '"clrs":[',IFNULL(getProductImages(2,v.StrollerID),''),'],',
                IF(getProductPurchaseInfo(2,v.StrollerID) IS NOT NULL,CONCAT('"mrchnts":[',getProductPurchaseInfo(2,v.StrollerID),'],'),''),
                '"strs":[',IFNULL(getStrs(2,v.StrollerID),''),'],',
                '"attrs":[',
                '{"ky":"ColorCount", "vl":"',IFNULL(getProductColorCount(2,v.StrollerID),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"Manufacturer", "vl":"',2),'{"ky":"Manufacturer","vl":"'),IFNULL(v.Manufacturer,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ProductModelName", "vl":"',2),'{"ky":"ProductModelName", "vl":"'),IFNULL(v.ProductModelName,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ProductModelNo", "vl":"',2),'{"ky":"ProductModelNo", "vl":"'),IFNULL(v.ProductModelNo,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ProductImageUrl", "vl":"',2),'{"ky":"ProductImageUrl", "vl":"'),IFNULL(getDefaultProductImage(2,v.StrollerID),'null'),'"},',
                '{"ky":"ProductUrl", "vl":"',IFNULL(urlencode(getProductURL(v.Brand, v.ProductModelName)),'null'),'"},',
                '{"ky":"BestForTallParents", "vl":"',IFNULL(v.BestForTallParents,'null'),'"},',
                '{"ky":"BestForInfants", "vl":"',IFNULL(v.BestForInfants,'null'),'"},',
                '{"ky":"BestForMultipleAgedChildren", "vl":"',IFNULL(v.BestForMultipleAgedChildren,'null'),'"},',
                '{"ky":"BestForToddlersOlderKids", "vl":"',IFNULL(v.BestForToddlersOlderKids,'null'),'"},',
                '{"ky":"BestForGrowingFamily", "vl":"',IFNULL(v.BestForGrowingFamily,'null'),'"},',
                '{"ky":"BestForAirplaneTravel", "vl":"',IFNULL(v.BestForAirplaneTravel,'null'),'"},',
                '{"ky":"BestForUrbanLiving", "vl":"',IFNULL(v.BestForUrbanLiving,'null'),'"},',
                IF(v.BestForSummary IS NOT NULL,CONCAT(getProductDetailGroups('{"ky":"BestForSummary","vl":"',2),BestForSummary,'"},'),''),
                '{"ky":"ThingsMatterModernStyle", "vl":"',IFNULL(v.ThingsMatterModernStyle,'null'),'"},',
                '{"ky":"ThingsMatterSportyStyle", "vl":"',IFNULL(v.ThingsMatterSportyStyle,'null'),'"},',
                '{"ky":"ThingsMatterInnovativeDesign", "vl":"',IFNULL(v.ThingsMatterInnovativeDesign,'null'),'"},',
                '{"ky":"ThingsMatterLightweight", "vl":"',IFNULL(v.ThingsMatterLightweight,'null'),'"},',
                '{"ky":"ThingsMatterEZManeuver", "vl":"',IFNULL(v.ThingsMatterEZManeuver,'null'),'"},',
                '{"ky":"ThingsMatterCompact", "vl":"',IFNULL(v.ThingsMatterCompact,'null'),'"},',
                IF(v.ThingsMatterSummary IS NOT NULL,CONCAT(getProductDetailGroups('{"ky":"ThingsMatterSummary", "vl":"',2),ThingsMatterSummary,'"},'),''),
                '{"ky":"',v.NumberSeatsFilter,'", "vl":"true"},',
                IFNULL(getProductDetailGroups('{"ky":"UPC", "vl":"',2),'{"ky":"UPC", "vl":"'), IFNULL(v.UPC,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"GTIN", "vl":"',2),'{"ky":"GTIN", "vl":"'),IFNULL(v.GTIN,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"Country", "vl":"',2),'{"ky":"Country",  "vl":"'),IFNULL(v.Country,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"JPMACertified", "vl":"',2),'{"ky":"JPMACertified","vl":"'),IFNULL(v.JPMACertified,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ASTMF833Tested", "vl":"',2),'{"ky":"ASTMF833Tested", "vl":"'),IFNULL(v.ASTMF833Tested,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"TUVTested", "vl":"',2),'{"ky":"TUVTested","vl":"'),IFNULL(v.TUVTested,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"EN1888Tested", "vl":"',2),'{"ky":"EN1888Tested","vl":"'),IFNULL(v.EN1888Tested,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"SOR85_379Tested", "vl":"',2),'{"ky":"SOR85_379Tested", "vl":"'),IFNULL(v.SOR85_379Tested,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CPSIA2008Tested", "vl":"',2),'{"ky":"CPSIA2008Tested", "vl":"'),IFNULL(v.CPSIA2008Tested,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"SafetyCertification", "vl":"',2),'{"ky":"SafetyCertification", "vl":"'),IFNULL(v.SafetyCertification,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ConsumerReportsRated", "vl":"',2),'{"ky":"ConsumerReportsRated", "vl":"'),IFNULL(v.ConsumerReportsRated,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CRSafety", "vl":"',2),'{"ky":"CRSafety", "vl":"'),IFNULL(v.CRSafety,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RecallEvent", "vl":"',2),'{"ky":"RecallEvent", "vl":"'),IFNULL(v.RecallEvent,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RecallDate", "vl":"',2),'{"ky":"RecallDate", "vl":"'),IFNULL(v.RecallDate,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RecallUnits", "vl":"',2),'{"ky":"RecallUnits","vl":"'),IFNULL(v.RecallUnits,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RecallHazard", "vl":"',2),'{"ky":"RecallHazard","vl":"'),IFNULL(v.RecallHazard,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RecallIncidentsInjuries", "vl":"',2),'{"ky":"RecallIncidentsInjuries", "vl":"'),IFNULL(v.RecallIncidentsInjuries,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RecallSeverity", "vl":"',2),'{"ky":"RecallSeverity", "vl":"'),IFNULL(v.RecallSeverity,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"StrollerTypeTraditional", "vl":"',2),'{"ky":"StrollerTypeTraditional", "vl":"'),IFNULL(StrollerTypeTraditional,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"StrollerTypeMultiFunction", "vl":"',2),'{"ky":"StrollerTypeMultiFunction", "vl":"'),IFNULL(StrollerTypeMultiFunction,'null'),'"}, ',
                IFNULL(getProductDetailGroups('{"ky":"StrollerTypePrams", "vl":"',2),'{"ky":"StrollerTypePrams", "vl":"'),IFNULL(StrollerTypePrams,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"StrollerTypeLightwtUmbrella", "vl":"',2),'{"ky":"StrollerTypeLightwtUmbrella", "vl":"'),IFNULL(StrollerTypeLightwtUmbrella,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"StrollerTypeJogging", "vl":"',2),'{"ky":"StrollerTypeJogging", "vl":"'),IFNULL(StrollerTypeJogging,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"StrollerTypeAllTerrain", "vl":"',2),'{"ky":"StrollerTypeAllTerrain", "vl":"'),IFNULL(StrollerTypeAllTerrain,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"StrollerTypeMultiple", "vl":"',2),'{"ky":"StrollerTypeMultiple", "vl":"'),IFNULL(StrollerTypeMultiple,'null'),'"},',
                IF(SummaryStrollerType IS NOT NULL,CONCAT(getProductDetailGroups('{"ky":"SummaryStrollerType", "vl":"',2),SummaryStrollerType,'"},'),''),
                IF(v.NumberSeats IS NOT NULL,CONCAT(getProductDetailGroups('{"ky":"NumberSeats", "vl":"',2),NumberSeats,'"},'),''),
                IFNULL(getProductDetailGroups('{"ky":"Multiplekids", "vl":"',2),'{"ky":"Multiplekids", "vl":"'),IFNULL(v.Multiplekids,'null'),'"},',
                IF(v.FootBoardPrice IS NOT NULL,CONCAT(getProductDetailGroupsAccessories(2,'{"ky":"FootBoardPrice", "vl":"',FootBoardPrice),v.FootBoardPriceAcc,'"},'),''),
                IF(v.JoggerConversionPrice IS NOT NULL,CONCAT(getProductDetailGroupsAccessories(2,'{"ky":"JoggerConversionPrice", "vl":"',JoggerConversionPrice),v.JoggerConversionPrice,'"},'),''),
                IFNULL(getProductDetailGroups('{"ky":"NewbornToToddler", "vl":"',2),'{"ky":"NewbornToToddler", "vl":"'),IFNULL(v.NewbornToToddler,'null'),'"},',
                IF(v.Bassinet IS NOT NULL,CONCAT(getProductDetailGroupsAccessories(2,'{"ky":"Bassinet","vl":"',Bassinet),v.BassinetAcc,'"},'),''),
                IFNULL(getProductDetailGroups('{"ky":"BassinetPrice", "vl":"',2),'{"ky":"BassinetPrice","vl":"'),IFNULL(v.BassinetPrice,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BassinetAdaptorPrice", "vl":"',2),'{"ky":"BassinetAdaptorPrice", "vl":"'),IFNULL(v.BassinetAdaptorPrice,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RecliningSeat", "vl":"',2),'{"ky":"RecliningSeat","vl":"'),IFNULL(v.RecliningSeat,'null'),'"},',
                IF(v.CarSeatAdaptable IS NOT NULL,CONCAT(getProductDetailGroupsAccessories(2,'{"ky":"CarSeatAdaptable", "vl":"',CarSeatAdaptable),v.CarSeatAdaptableAcc,'"},'),''),
                IFNULL(getProductDetailGroups('{"ky":"NumberOfCarSeatBrands", "vl":"',2),'{"ky":"NumberOfCarSeatBrands", "vl":"'),IFNULL(v.NumberOfCarSeatBrands,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"NumberOfCarSeatModels", "vl":"',2),'{"ky":"NumberOfCarSeatModels", "vl":"'),IFNULL(v.NumberOfCarSeatModels,'null'),'"},',
                IF(v.CarSeatLists IS NOT NULL,CONCAT(getProductDetailGroups('{"ky":"CarSeatLists", "vl":"',2),v.CarSeatLists,'"},'),''),
                IFNULL(getProductDetailGroups('{"ky":"WeightLbs", "vl":"',2),'{"ky":"WeightLbs","vl":"'),IFNULL(v.WeightLbs,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"MaximumWeightOfChildLbs", "vl":"',2),'{"ky":"MaximumWeightOfChildLbs", "vl":"'),IFNULL(v.MaximumWeightOfChildLbs,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"DimensionsInchesFull_W", "vl":"',2),'{"ky":"DimensionsInchesFull_W", "vl":"'),IFNULL(v.DimensionsInchesFull_W,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"DimensionsInchesFull_D", "vl":"',2),'{"ky":"DimensionsInchesFull_D", "vl":"'),IFNULL(v.DimensionsInchesFull_D,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"DimensionsInchesFull_H", "vl":"',2),'{"ky":"DimensionsInchesFull_H", "vl":"'),IFNULL(v.DimensionsInchesFull_H,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"DimensionsInchesFull_HWD", "vl":"',2),'{"ky":"DimensionsInchesFull_HWD", "vl":"'),IFNULL(v.DimensionsInchesFull_HWD,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"DimensionsInchesFolded_W", "vl":"',2),'{"ky":"DimensionsInchesFolded_W", "vl":"'),IFNULL(v.DimensionsInchesFolded_W,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"DimensionsInchesFolded_D", "vl":"',2),'{"ky":"DimensionsInchesFolded_D", "vl":"'),IFNULL(v.DimensionsInchesFolded_D,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"DimensionsInchesFolded_H", "vl":"',2),'{"ky":"DimensionsInchesFolded_H", "vl":"'),IFNULL(v.DimensionsInchesFolded_H,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"DimensionsInchesFolded_HWD", "vl":"',2),'{"ky":"DimensionsInchesFolded_HWD", "vl":"'),IFNULL(v.DimensionsInchesFolded_HWD,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"FoldType", "vl":"',2),'{"ky":"FoldType","vl":"'),IFNULL(v.FoldType,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ReplaceableFabric", "vl":"',2), '{"ky":"ReplaceableFabric", "vl":"'),IFNULL(v.ReplaceableFabric,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"MachineWashable", "vl":"',2),'{"ky":"MachineWashable", "vl":"'),IFNULL(v.MachineWashable,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ListPriceRange", "vl":"',2),'{"ky":"ListPriceRange", "vl":"'),IFNULL(v.ListPriceRange,'null'),'"},',
                '{"ky":"ListPrice", "vl":',IFNULL(v.ListPrice,0.00),'},',
                getLowestPriceInfo(2,v.StrollerID),',',
                IFNULL(getProductDetailGroups('{"ky":"SalePrice", "vl":"',2),'{"ky":"SalePrice", "vl":"'),IFNULL(v.SalePrice,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"NewModelDiscount", "vl":"',2),'{"ky":"NewModelDiscount", "vl":"'),IFNULL(v.NewModelDiscount,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ResaleValue", "vl":"',2),'{"ky":"ResaleValue", "vl":"'),IFNULL(v.ResaleValue,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"NumberOfColorsOrPatternsAvailableNeon", "vl":"',2),'{"ky":"NumberOfColorsOrPatternsAvailableNeon", "vl":"'),IFNULL(v.NumberOfColorsOrPatternsAvailableNeon,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"NumberOfColorsOrPatternsAvailableVeryBrightOrPrimary","vl":"',2),'{"ky":"NumberOfColorsOrPatternsAvailableVeryBrightOrPrimary","vl":"'),IFNULL(v.NumberOfColorsOrPatternsAvailableVeryBrightOrPrimary,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"NumberOfColorsOrPatternsAvailableNeutralEarthTones","vl":"',2),'{"ky":"NumberOfColorsOrPatternsAvailableNeutralEarthTones","vl":"'), IFNULL(v.NumberOfColorsOrPatternsAvailableNeutralEarthTones,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"NumberOfColorsOrPatternsAvailableDeepBluePurples", "vl":"',2),'{"ky":"NumberOfColorsOrPatternsAvailableDeepBluePurples","vl":"'),IFNULL(v.NumberOfColorsOrPatternsAvailableDeepBluePurples,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"NumberOfColorsOrPatternsAvailableGrayOrBlack","vl":"',2),'{"ky":"NumberOfColorsOrPatternsAvailableGrayOrBlack", "vl":"'),IFNULL(v.NumberOfColorsOrPatternsAvailableGrayOrBlack,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ManufacturerColor", "vl":"',2),'{"ky":"ManufacturerColor", "vl":"'),IFNULL(v.ManufacturerColor,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RearForwardFacing", "vl":"',2),'{"ky":"RearForwardFacing", "vl":"'),IFNULL(v.RearForwardFacing,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"FrontWheelMaterial", "vl":"',2),'{"ky":"FrontWheelMaterial", "vl":"'),IFNULL(v.FrontWheelMaterial,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"FrontWheelType", "vl":"',2),'{"ky":"FrontWheelType", "vl":"'),IFNULL(v.FrontWheelType,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BackWheelMaterial", "vl":"',2),'{"ky":"BackWheelMaterial", "vl":"'),IFNULL(v.BackWheelMaterial,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BackWheelType", "vl":"',2),'{"ky":"BackWheelType","vl":"'),IFNULL(v.BackWheelType,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"AdjustableHandle", "vl":"',2),'{"ky":"AdjustableHandle", "vl":"'),IFNULL(v.AdjustableHandle,'null'),'"},',
                IF(v.AdultCupHolder IS NOT NULL,CONCAT(getProductDetailGroupsAccessories(2,'{"ky":"AdultCupHolder", "vl":"',AdultCupHolder),v.AdultCupHolderAcc,'"},'),''),
                IFNULL(getProductDetailGroups('{"ky":"AdultCupHolderPrice", "vl":"',2),'{"ky":"AdultCupHolderPrice", "vl":"'),IFNULL(v.AdultCupHolderPrice,'null'),'"},',
                IF(v.ChildsFoodTray IS NOT NULL,CONCAT(getProductDetailGroupsAccessories(2,'{"ky":"ChildsFoodTray", "vl":"',ChildsFoodTray),v.ChildsFoodTrayAcc,'"},'),''),
                IFNULL(getProductDetailGroups('{"ky":"ChildsFoodTrayPrice", "vl":"',2),'{"ky":"ChildsFoodTrayPrice", "vl":"'),IFNULL(v.ChildsFoodTrayPrice,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CushionedOrPaddedSeat", "vl":"',2),'{"ky":"CushionedOrPaddedSeat", "vl":"'),IFNULL(v.CushionedOrPaddedSeat,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CanopyType", "vl":"',2),'{"ky":"CanopyType","vl":"'),IFNULL(v.CanopyType,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"PeekabooWindow", "vl":"',2),'{"ky":"PeekabooWindow", "vl":"'),IFNULL(v.PeekabooWindow,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"LegRest", "vl":"',2),'{"ky":"LegRest","vl":"'),IFNULL(v.LegRest,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"FootRest", "vl":"',2),'{"ky":"FootRest","vl":"'),IFNULL(v.FootRest,'null'),'"},',
                IF(v.InfantHeadRest IS NOT NULL,CONCAT(getProductDetailGroupsAccessories(2,'{"ky":"InfantHeadRest", "vl":"',InfantHeadRest),v.InfantHeadRestAcc,'"},'),''),
                IFNULL(getProductDetailGroups('{"ky":"ShoulderPads", "vl":"',2),'{"ky":"ShoulderPads","vl":"'),IFNULL(v.ShoulderPads,'null'),'"},',
                IF(v.RainProtection IS NOT NULL,CONCAT(getProductDetailGroupsAccessories(2,'{"ky":"RainProtection", "vl":"',RainProtection),v.RainProtectionAcc,'"},'),''),
                IFNULL(getProductDetailGroups('{"ky":"RainProtectionPrice", "vl":"',2),'{"ky":"RainProtectionPrice", "vl":"'),IFNULL(v.RainProtectionPrice,'null'),'"},',
                IF(v.UVProtection IS NOT NULL,CONCAT(getProductDetailGroupsAccessories(2,'{"ky":"UVProtection","vl":"',UVProtection),v.UVProtectionAcc,'"},'),''),
                IFNULL(getProductDetailGroups('{"ky":"UVProtectionPrice", "vl":"',2),'{"ky":"UVProtectionPrice", "vl":"'),IFNULL(v.UVProtectionPrice ,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"StorageBasket", "vl":"',2),'{"ky":"StorageBasket", "vl":"'),IFNULL(v.StorageBasket,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"Harness", "vl":"',2),'{"ky":"Harness","vl":"'),IFNULL(v.Harness,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"OneTouchBrakesFoot", "vl":"',2),'{"ky":"OneTouchBrakesFoot", "vl":"'),IFNULL(v.OneTouchBrakesFoot,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"OneTouchBrakesHand", "vl":"',2),'{"ky":"OneTouchBrakesHand", "vl":"'),IFNULL(v.OneTouchBrakesHand,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CREaseOfUse", "vl":"',2),'{"ky":"CREaseOfUse", "vl":"'),IFNULL(v.CREaseOfUse,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CRManeuverability", "vl":"',2), '{"ky":"CRManeuverability", "vl":"'),IFNULL(v.CRManeuverability,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CRFoldedSize", "vl":"',2),'{"ky":"CRFoldedSize", "vl":"'),IFNULL(v.CRFoldedSize,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BestUses", "vl":"',2),'{"ky":"BestUses","vl":"'),IFNULL(v.BestUses,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"Extras", "vl":"',2),'{"ky":"Extras", "vl":"'),IFNULL(v.Extras,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ProductOverview", "vl":"',2),'{"ky":"ProductOverview", "vl":"'),IFNULL(REPLACE(v.ProductOverview,'     ',''),'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"FacebookURL", "vl":"',2),'{"ky":"FacebookURL","vl":"'),IFNULL(v.FacebookURL,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BrandFacebookLikes", "vl":"',2),'{"ky":"BrandFacebookLikes", "vl":"'),IFNULL(v.FacebookLikes,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"TwitterName", "vl":"',2),'{"ky":"TwitterName", "vl":"'),IFNULL(v.TwitterName,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"TwitterURL", "vl":"',2),'{"ky":"TwitterURL", "vl":"'),IFNULL(v.TwitterURL,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BrandTwitterFollowers", "vl":"',2),'{"ky":"BrandTwitterFollowers", "vl":"'),IFNULL(v.TwitterFollowers,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BabiesRUSTopSelling", "vl":"',2),'{"ky":"BabiesRUSTopSelling", "vl":"'),IFNULL(v.BabiesRUSTopSelling,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BabyGagaParentRating", "vl":"',2),'{"ky":"BabyGagaParentRating", "vl":"'),IFNULL(v.BabyGagaParentRating,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BabyBargainsRating", "vl":"',2),'{"ky":"BabyBargainsRating", "vl":"'),IFNULL(v.BabyBargainsRating,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BabyGagaDurability", "vl":"',2),'{"ky":"BabyGagaDurability", "vl":"'),IFNULL(v.BabyGagaDurability,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"NAPPARecipient", "vl":"',2),'{"ky":"NAPPARecipient", "vl":"'),IFNULL(v.NAPPARecipient,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"JPMARecipient", "vl":"',2),'{"ky":"JPMARecipient", "vl":"'),IFNULL(v.JPMARecipient,'null'),'"},',
                IF(LENGTH(v.Awards) <> 0,CONCAT(getProductDetailGroups('{"ky":"Awards", "vl":"',2),v.Awards,'"},'),''),
                IFNULL(getProductDetailGroups('{"ky":"CROverallScore", "vl":"',2),'{"ky":"CROverallScore", "vl":"'),IFNULL(v.CROverallScore,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CRComment", "vl":"',2),'{"ky":"CRComment", "vl":"'),IFNULL(v.CRComment,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BabiesRUsParentRating", "vl":"',2),'{"ky":"BabiesRUsParentRating", "vl":"'),IFNULL(v.BabiesRUsParentRating,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"DesignStyle", "vl":"',2),'{"ky":"DesignStyle", "vl":"'),IFNULL(v.DesignStyle,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"MediaSpotlight", "vl":"',2),'{"ky":"MediaSpotlight", "vl":"'),IFNULL(v.MediaSpotlight,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CelebritySightings", "vl":"',2),'{"ky":"CelebritySightings", "vl":"'),IFNULL(v.CelebritySightings,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"GiggleListed", "vl":"',2),'{"ky":"GiggleListed","vl":"'),IFNULL(v.GiggleListed,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BabbleRecognition", "vl":"',2),'{"ky":"BabbleRecognition", "vl":"'),IFNULL(v.BabbleRecognition,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"AdditionalSeatType", "vl":"',2),'{"ky":"AdditionalSeatType", "vl":"'),IFNULL(v.AdditionalSeatType,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"FootBoard", "vl":"',2),'{"ky":"FootBoard", "vl":"'),IFNULL(v.FootBoard,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"MaxNumberOfConfiguration", "vl":"',2),'{"ky":"MaxNumberOfConfiguration", "vl":"'),IFNULL(v.MaxNumberOfConfiguration,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"Lights", "vl":"',2),'{"ky":"Lights", "vl":"'),IFNULL(v.Lights,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BumperBar", "vl":"',2),'{"ky":"BumperBar", "vl":"'),IFNULL(v.BumperBar,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CarryingStrap", "vl":"',2),'{"ky":"CarryingStrap", "vl":"'),IFNULL(v.CarryingStrap,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"InteractiveTechSavvy", "vl":"',2),'{"ky":"InteractiveTechSavvy", "vl":"'),IFNULL(v.InteractiveTechSavvy,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"addLCDDisplaySystem", "vl":"',2),'{"ky":"addLCDDisplaySystem", "vl":"'),IFNULL(v.addLCDDisplaySystem,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"Pedometer", "vl":"',2),'{"ky":"Pedometer", "vl":"'),IFNULL(v.Pedometer,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"Thermometer", "vl":"',2),'{"ky":"Thermometer", "vl":"'),IFNULL(v.Thermometer,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"SafetySensor", "vl":"',2),'{"ky":"SafetySensor", "vl":"'),IFNULL(v.SafetySensor,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"SolarPanals", "vl":"',2),'{"ky":"SolarPanals", "vl":"'),IFNULL(v.SolarPanals,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"CellPhoneCharger", "vl":"',2),'{"ky":"CellPhoneCharger", "vl":"'),IFNULL(v.CellPhoneCharger,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BuiltinGenerator", "vl":"',2),'{"ky":"BuiltinGenerator", "vl":"'),IFNULL(v.BuiltinGenerator,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"NumberOfCupHolders", "vl":"',2),'{"ky":"NumberOfCupHolders", "vl":"'),IFNULL(v.NumberOfCupHolders,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"ParentsFoodTray", "vl":"',2),'{"ky":"ParentsFoodTray", "vl":"'),IFNULL(v.ParentsFoodTray,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"RemovableCanopy", "vl":"',2),'{"ky":"RemovableCanopy", "vl":"'),IFNULL(v.RemovableCanopy,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"PTPAAwardWinner", "vl":"',2),'{"ky":"PTPAAwardWinner", "vl":"'),IFNULL(v.PTPAAwardWinner,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"YoutubeURL", "vl":"',2),'{"ky":"YoutubeURL", "vl":"'),IFNULL(v.YoutubeURL,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"YoutubeViews", "vl":"',2),'{"ky":"YoutubeViews", "vl":"'),IFNULL(v.YoutubeViews,'null'),'"},',
                IFNULL(getProductDetailGroups('{"ky":"BabbleRecognition2012", "vl":"',2),'{"ky":"BabbleRecognition2012", "vl":"'),IFNULL(v.BabbleRecognition2012,'null'),'"},',
                IF(LENGTH(v.YouTubeVideoID_1) <> 0,CONCAT('{"ky":"YouTubeVideoID_1", "vl":"',v.YouTubeVideoID_1,'"},'),''),
                IF(LENGTH(v.YouTubeVideoTitle_1) <> 0,CONCAT('{"ky":"YouTubeVideoTitle_1", "vl":"',v.YouTubeVideoTitle_1,'"},'),''),
                IF(LENGTH(v.YouTubeVideoID_2) <> 0,CONCAT('{"ky":"YouTubeVideoID_2", "vl":"',v.YouTubeVideoID_2,'"},'),''),
                IF(LENGTH(v.YouTubeVideoTitle_2) <> 0,CONCAT('{"ky":"YouTubeVideoTitle_2", "vl":"',v.YouTubeVideoTitle_2,'"},'),''),
                IFNULL(getProductDetailGroups('{"ky":"BabyBargainsRecognition", "vl":"',2),'{"ky":"BabyBargainsRecognition", "vl":"'),IFNULL(v.BabyBargainsRecognition,'null'),'"}], ','"mtvtrs" : {',
                '"A":',IFNULL(m.A,0),',',
                '"B":',IFNULL(m.B,0),',',
                '"C":',IFNULL(m.C,0),',',
                '"D":',IFNULL(m.D,0),',',
                '"E":',IFNULL(m.E,0),',',
                '"F":',IFNULL(m.F,0),',',
                '"G":',IFNULL(m.G,0),',',
                '"H":',IFNULL(m.H,0),',',
                '"I":',IFNULL(m.I,0),',',
                '"J":',IFNULL(m.J,0),',',
                '"K":',IFNULL(m.K,0),',',
                '"L":',IFNULL(m.L,0),'',
                '}}'),'"null"','null')) AS payload
                FROM vw_stroller_data_ui v
                JOIN vw_stroller_motivators m
                 ON v.StrollerID = m.ItemID
                 AND m.CategoryID = v.CategoryID
                WHERE getDefaultProductImage(2,v.StrollerID) IS NOT NULL
                AND getLowestPriceInfo(2,v.StrollerID) IS NOT NULL
                GROUP BY v.StrollerID
                ]]>
            </value>
        </property>
        <property name="ingestService" ref="itemService"/>
        <property name="ingestMethod" value="saveItems"/>
        <property name="jsonType" value="com.lela.domain.document.Item"/>
        <property name="batchSize" value="10"/>
        <property name="etlUpdateQuery">
            <value>
                <![CDATA[
                update stroller_data set objectId = '@{id}', isdirty = -1 where strollerid = @{tld}
                ]]>
            </value>
        </property>
    </bean>
    -->
    <!--
        POSTAL CODE (ZIPCODE) INGEST JOB
    -->
    <bean id="postalCodeEtlJobDetailTrigger" class="org.springframework.scheduling.quartz.CronTriggerBean">
        <property name="jobDetail" ref="postalCodeEtlJobDetail"/>
        <property name="cronExpression" value="0 7 3 * * ?"/>
        <property name="misfireInstructionName" value="MISFIRE_INSTRUCTION_DO_NOTHING"/>
    </bean>

    <bean id="postalCodeEtlJobDetail" class="com.lela.commons.jobs.etl.EtlJobDetail">
        <property name="name" value="Ingest Postal Code"/>
        <property name="sqlQuery">
            <value>
                <![CDATA[
                SELECT
                REPLACE(CONCAT('{ "tld":"',ZipCodeId,'",',
                    case when objectID is not null then concat('"id":"', objectid ,'",') else '' end,
                    '"cd":"',IFNULL(PostalCode,'null'),'",',
                    case when lat is not null && lng is not null then concat('"lc": [', lng, ', ', lat, '],') else '' end,
                    '"st":"',IFNULL(state,'null'),'",',
                    '"stnm":"',IFNULL(StateName,'null'),'",',
                    '"ct":"',IFNULL(city,'null'),'"',
                    '}'),'"null"','null') merchant
                FROM zip_code
                WHERE isdirty = 1
                ]]>
            </value>
        </property>
        <property name="ingestService" ref="postalCodeService"/>
        <property name="ingestMethod" value="savePostalCodes"/>
        <property name="jsonType" value="com.lela.domain.document.PostalCode"/>
        <property name="batchSize" value="10"/>
        <property name="etlUpdateQuery">
            <value>
                <![CDATA[
                update zipcode set objectId = '@{id}', isdirty = -1 where id = @{tld}
                ]]>
            </value>
        </property>
    </bean>
    <!--
        HIGH CHAIR INGEST JOB
    -->
    <!--
    <bean id="highchairEtlJobDetailTrigger" class="org.springframework.scheduling.quartz.CronTriggerBean">
        <property name="jobDetail" ref="highchairEtlJobDetail"/>
        <property name="cronExpression" value="0 6 3 * * ?"/>
    </bean>
    -->
    <!--
    <bean id="highchairEtlJobDetail" class="com.lela.commons.jobs.etl.EtlJobDetail">
        <property name="name" value="Ingest High Chair"/>
        <property name="interceptors">
            <list>
                <ref bean="functionalFiltersIngestJobInterceptor"/>
            </list>
        </property>
        <property name="preExecutionQueries">
            <list>
                <value>call create_view_tables</value>
            </list>
        </property>

        <property name="sqlQuery">
            <value>
                <![CDATA[
       SELECT group_concat(replace(concat('{"nm":"', v.Model, '",',
       '"lcl":"en_US",',
       '"tp":"PRODUCT",',
       '"tld":"', ifnull(v.HighChair_ID, 'null'), '",',
       '"rlnm":"', v.URLName, '",',
       '"srlnm":"', ifnull(v.LelaURL, 'null'), '",',
       if(v.objectID IS NOT NULL, concat('"id":"', v.objectID, '",'), '"id": null,'),
       '"sbttrs":[',
       '{"ky":"Brand", "vl":"', ifnull(v.Brand, 'null'), '"},',
       '{"ky":"ProductModelName", "vl":"', ifnull(v.Model, 'null'), '"},',
       '{"ky":"ListPrice", "vl":', ifnull(cast(replace(v.ListPrice, '$', '') AS DECIMAL(8, 2)), 'null'), '},',
       getLowestPriceInfo(15, v.HighChair_ID), ',',
       '{"ky":"ProductImageUrl", "vl":"', ifnull(getDefaultProductImage(15, v.HighChair_ID), 'null'), '"}',
       '],',
       '"ctgry":', getCategory(15), ',',
       '"wnr":', getOwner(15, v.BrandID), ',',
       '"clrs":[', ifnull(getProductImages(15, v.HighChair_ID), ''), '],',
       if(getProductPurchaseInfo(15, v.HighChair_ID) IS NOT NULL, concat('"mrchnts":[', getProductPurchaseInfo(15, v.HighChair_ID), '],'), ''),
       '"strs":[', ifnull(getStrs(15, v.HighChair_ID), ''), '],',
       '"attrs":[',
       ifnull(getProductDetailGroups('{"ky":"HighChair_ID", "vl":"', 15), '{"ky":"HighChair_ID", "vl":"'), ifnull(HighChair_ID, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"CategoryID", "vl":"', 15), '{"ky":"CategoryID", "vl":"'), ifnull(v.CategoryID, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"Brand", "vl":"', 15), '{"ky":"Brand", "vl":"'), ifnull(Brand, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"BrandID", "vl":"', 15), '{"ky":"BrandID", "vl":"'), ifnull(BrandID, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"URLName", "vl":"', 15), '{"ky":"URLName", "vl":"'), ifnull(URLName, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"objectID", "vl":"', 15), '{"ky":"objectID", "vl":"'), ifnull(objectID, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"Manufacturer", "vl":"', 15), '{"ky":"Manufacturer", "vl":"'), ifnull(Manufacturer, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"Validated", "vl":"', 15), '{"ky":"Validated", "vl":"'), ifnull(Validated, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"ProductModelName", "vl":"', 15), '{"ky":"ProductModelName", "vl":"'), ifnull(Model, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"ModelNumber", "vl":"', 15), '{"ky":"ModelNumber", "vl":"'), ifnull(ModelNumber, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"HighChairType", "vl":"', 15), '{"ky":"HighChairType", "vl":"'), ifnull(HighChairType, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"HighChairTypeMultifunctional", "vl":"', 15), '{"ky":"HighChairTypeMultifunctional", "vl":"'), ifnull(HighChairTypeMultifunctional, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"HighChairTypeStandard", "vl":"', 15), '{"ky":"HighChairTypeStandard", "vl":"'), ifnull(HighChairTypeStandard, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"HighChairTypeBooster", "vl":"', 15), '{"ky":"HighChairTypeBooster", "vl":"'), ifnull(HighChairTypeBooster, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"HighChairTypeTravel", "vl":"', 15), '{"ky":"HighChairTypeTravel", "vl":"'), ifnull(HighChairTypeTravel, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"HighChairTypeTableTop", "vl":"', 15), '{"ky":"HighChairTypeTableTop", "vl":"'), ifnull(HighChairTypeTableTop, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"HighChairTypeDetachableSpaceSaver", "vl":"', 15), '{"ky":"HighChairTypeDetachableSpaceSaver", "vl":"'), ifnull(HighChairTypeDetachableSpaceSaver, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"SummaryHighChairType", "vl":"', 15), '{"ky":"SummaryHighChairType", "vl":"'), ifnull(SummaryHighChairType, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"BestForGrowsWithChild", "vl":"', 15), '{"ky":"BestForGrowsWithChild", "vl":"'), ifnull(BestForGrowsWithChild, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"BestForCompactSpaces", "vl":"', 15), '{"ky":"BestForCompactSpaces", "vl":"'), ifnull(BestForCompactSpaces, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"BestForEasyCleaning", "vl":"', 15), '{"ky":"BestForEasyCleaning", "vl":"'), ifnull(BestForEasyCleaning, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"BestForFamilyTravel", "vl":"', 15), '{"ky":"BestForFamilyTravel", "vl":"'), ifnull(BestForFamilyTravel, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"BestForSummary", "vl":"', 15), '{"ky":"BestForSummary", "vl":"'), ifnull(BestForSummary, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"FeatureModern", "vl":"', 15), '{"ky":"FeatureModern", "vl":"'), ifnull(FeatureModern, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"FeatureAdjustableSeating", "vl":"', 15), '{"ky":"FeatureAdjustableSeating", "vl":"'), ifnull(FeatureAdjustableSeating, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"FeatureErgonomic", "vl":"', 15), '{"ky":"FeatureErgonomic", "vl":"'), ifnull(FeatureErgonomic, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"FeatureWoodFrame", "vl":"', 15), '{"ky":"FeatureWoodFrame", "vl":"'), ifnull(FeatureWoodFrame, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"FeatureFoldable", "vl":"', 15), '{"ky":"FeatureFoldable", "vl":"'), ifnull(FeatureFoldable, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"FeatureMachineWashableCushion", "vl":"', 15), '{"ky":"FeatureMachineWashableCushion", "vl":"'), ifnull(FeatureMachineWashableCushion, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"FeatureRemovableTray", "vl":"', 15), '{"ky":"FeatureRemovableTray", "vl":"'), ifnull(FeatureRemovableTray, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"Feature5ptHarness", "vl":"', 15), '{"ky":"Feature5ptHarness", "vl":"'), ifnull(Feature5ptHarness, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"FeatureSafetyTbar", "vl":"', 15), '{"ky":"FeatureSafetyTbar", "vl":"'), ifnull(FeatureSafetyTbar, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"FeatureWheels", "vl":"', 15), '{"ky":"FeatureWheels", "vl":"'), ifnull(FeatureWheels, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"FeatureLockingMechanism", "vl":"', 15), '{"ky":"FeatureLockingMechanism", "vl":"'), ifnull(FeatureLockingMechanism, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"Priority", "vl":"', 15), '{"ky":"Priority", "vl":"'), ifnull(Priority, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"BBBrandRating", "vl":"', 15), '{"ky":"BBBrandRating", "vl":"'), ifnull(BBBrandRating, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"BBModelRecommended", "vl":"', 15), '{"ky":"BBModelRecommended", "vl":"'), ifnull(BBModelRecommended, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"BabbleRecommended", "vl":"', 15), '{"ky":"BabbleRecommended", "vl":"'), ifnull(BabbleRecommended, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"GigglesListed", "vl":"', 15), '{"ky":"GigglesListed", "vl":"'), ifnull(GigglesListed, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"AvailableAmazon", "vl":"', 15), '{"ky":"AvailableAmazon", "vl":"'), ifnull(AvailableAmazon, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"ASIN", "vl":"', 15), '{"ky":"ASIN", "vl":"'), ifnull(ASIN, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"AmazonBestseller", "vl":"', 15), '{"ky":"AmazonBestseller", "vl":"'), ifnull(AmazonBestseller, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"AmazonCustomerRating", "vl":"', 15), '{"ky":"AmazonCustomerRating", "vl":"'), ifnull(AmazonCustomerRating, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"BabiesRUsBestseller", "vl":"', 15), '{"ky":"BabiesRUsBestseller", "vl":"'), ifnull(BRUsBestseller, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"BabiesRUsTopRated", "vl":"', 15), '{"ky":"BabiesRUsTopRated", "vl":"'), ifnull(BRUsTopRated, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"NAPPAAwardWinner", "vl":"', 15), '{"ky":"NAPPAAwardWinner", "vl":"'), ifnull(NAPPAAwardWinner, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"JPMAInnovationAwardWinner", "vl":"', 15), '{"ky":"JPMAInnovationAwardWinner", "vl":"'), ifnull(JPMAInnovationAwardWinner, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"PTPAAwardWinner", "vl":"', 15), '{"ky":"PTPAAwardWinner", "vl":"'), ifnull(PTPAAwardWinner, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"iParentingAwardWinner", "vl":"', 15), '{"ky":"iParentingAwardWinner", "vl":"'), ifnull(iParentingMediaAwardWinner, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"BrandURL", "vl":"', 15), '{"ky":"BrandURL", "vl":"'), ifnull(BrandURL, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"ModelURL", "vl":"', 15), '{"ky":"ModelURL", "vl":"'), ifnull(ModelURL, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"DesignStyle", "vl":"', 15), '{"ky":"DesignStyle", "vl":"'), ifnull(DesignStyle, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"BrandLevelMarketingPosition", "vl":"', 15), '{"ky":"BrandLevelMarketingPosition", "vl":"'), ifnull(BrandLevelMarketingPosition, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"CollectionLevelMarketingPositon", "vl":"', 15), '{"ky":"CollectionLevelMarketingPositon", "vl":"'), ifnull(CollectionLevelMarketingPositon, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"ProductOverview", "vl":"', 15), '{"ky":"ProductOverview", "vl":"'), ifnull(ProductOverview, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"CountryManufacturer", "vl":"', 15), '{"ky":"CountryManufacturer", "vl":"'), ifnull(Country, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"JPMACertified", "vl":"', 15), '{"ky":"JPMACertified", "vl":"'), ifnull(JPMACertified, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"ASTM", "vl":"', 15), '{"ky":"ASTM", "vl":"'), ifnull(ASTM, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"TUV", "vl":"', 15), '{"ky":"TUV", "vl":"'), ifnull(TUV, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"EN", "vl":"', 15), '{"ky":"EN", "vl":"'), ifnull(EN, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"CPSIACertified", "vl":"', 15), '{"ky":"CPSIACertified", "vl":"'), ifnull(CPSIACertified, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"CRTested", "vl":"', 15), '{"ky":"CRTested", "vl":"'), ifnull(CRTested, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"CRSafety", "vl":"', 15), '{"ky":"CRSafety", "vl":"'), ifnull(CRSafety, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"CREaseOfUse", "vl":"', 15), '{"ky":"CREaseOfUse", "vl":"'), ifnull(CREaseUse, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"CROverallScore", "vl":"', 15), '{"ky":"CROverallScore", "vl":"'), ifnull(CROverallScore, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"RecallEvent", "vl":"', 15), '{"ky":"RecallEvent", "vl":"'), ifnull(RecallEvent, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"RecallURL", "vl":"', 15), '{"ky":"RecallURL", "vl":"'), ifnull(RecallURL, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"RecallDate", "vl":"', 15), '{"ky":"RecallDate", "vl":"'), ifnull(RecallDate, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"RecallUnits", "vl":"', 15), '{"ky":"RecallUnits", "vl":"'), ifnull(RecallUnits, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"RecallHazard", "vl":"', 15), '{"ky":"RecallHazard", "vl":"'), ifnull(RecallHazard, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"RecallIncidentsInjuries", "vl":"', 15), '{"ky":"RecallIncidentsInjuries", "vl":"'), ifnull(RecallIncidents, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"RecallSeverity", "vl":"', 15), '{"ky":"RecallSeverity", "vl":"'), ifnull(RecallSeverity, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"FrameAllWhite", "vl":"', 15), '{"ky":"FrameAllWhite", "vl":"'), ifnull(FrameAllWhite, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"FrameDarkBrownStain", "vl":"', 15), '{"ky":"FrameDarkBrownStain", "vl":"'), ifnull(FrameDarkBrownStain, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"FrameMediumBrownStain", "vl":"', 15), '{"ky":"FrameMediumBrownStain", "vl":"'), ifnull(FrameMediumBrownStain, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"FrameLightBrownStain", "vl":"', 15), '{"ky":"FrameLightBrownStain", "vl":"'), ifnull(FrameLightBrownStain, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"FrameTanNatural", "vl":"', 15), '{"ky":"FrameTanNatural", "vl":"'), ifnull(FrameTanNatural, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"FrameOtherColors", "vl":"', 15), '{"ky":"FrameOtherColors", "vl":"'), ifnull(FrameOtherColors, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"FrameTotalNumberColors", "vl":"', 15), '{"ky":"FrameTotalNumberColors", "vl":"'), ifnull(FrameTotalNumberColors, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"ManufacturerFrameColorNames", "vl":"', 15), '{"ky":"ManufacturerFrameColorNames", "vl":"'), ifnull(ManufacturerFrameColorNames, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"CushionNeon", "vl":"', 15), '{"ky":"CushionNeon", "vl":"'), ifnull(CushionNeon, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"CushionVeryBrightPrimary", "vl":"', 15), '{"ky":"CushionVeryBrightPrimary", "vl":"'), ifnull(CushionVeryBrightPrimary, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"CushionNeutralEarthTones", "vl":"', 15), '{"ky":"CushionNeutralEarthTones", "vl":"'), ifnull(CushionNeutralEarthTones, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"CushionDeepBluePurples", "vl":"', 15), '{"ky":"CushionDeepBluePurples", "vl":"'), ifnull(CushionDeepBluePurples, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"CushionGrayBlack", "vl":"', 15), '{"ky":"CushionGrayBlack", "vl":"'), ifnull(CushionGrayBlack, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"CushionTotalNumberColors", "vl":"', 15), '{"ky":"CushionTotalNumberColors", "vl":"'), ifnull(CushionTotalNumberColors, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"ManufacturerSeatColorNames", "vl":"', 15), '{"ky":"ManufacturerSeatColorNames", "vl":"'), ifnull(ManufacturerSeatColorNames, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"Size_HWL", "vl":"', 15), '{"ky":"Size_HWL", "vl":"'), ifnull(Size_HWL, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"HighchairWeight", "vl":"', 15), '{"ky":"HighchairWeight", "vl":"'), ifnull(HighchairWeight, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"FoldType", "vl":"', 15), '{"ky":"FoldType", "vl":"'), ifnull(FoldType, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"Wheels", "vl":"', 15), '{"ky":"Wheels", "vl":"'), ifnull(Wheels, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"LockingMechanism", "vl":"', 15), '{"ky":"LockingMechanism", "vl":"'), ifnull(LockingMechanism, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"MinimumAge", "vl":"', 15), '{"ky":"MinimumAge", "vl":"'), ifnull(MinimumAge, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"MaximumAge", "vl":"', 15), '{"ky":"MaximumAge", "vl":"'), ifnull(MaximumAge, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"MinimumChildWeight", "vl":"', 15), '{"ky":"MinimumChildWeight", "vl":"'), ifnull(MinimumChildWeight, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"MaximumChildWeight", "vl":"', 15), '{"ky":"MaximumChildWeight", "vl":"'), ifnull(MaximumChildWeight, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"Harness", "vl":"', 15), '{"ky":"Harness", "vl":"'), ifnull(Harness, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"GrabRail", "vl":"', 15), '{"ky":"GrabRail", "vl":"'), ifnull(GrabRail, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"CrotchPost", "vl":"', 15), '{"ky":"CrotchPost", "vl":"'), ifnull(CrotchPost, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"Ergonomic", "vl":"', 15), '{"ky":"Ergonomic", "vl":"'), ifnull(Ergonomic, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"SeatFunction", "vl":"', 15), '{"ky":"SeatFunction", "vl":"'), ifnull(SeatFunction, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"SeatRecline", "vl":"', 15), '{"ky":"SeatRecline", "vl":"'), ifnull(SeatRecline, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"SeatCushion", "vl":"', 15), '{"ky":"SeatCushion", "vl":"'), ifnull(SeatCushion, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"SeatCushionMaterial", "vl":"', 15), '{"ky":"SeatCushionMaterial", "vl":"'), ifnull(SeatCushionMaterial, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"SeatCushionWashable", "vl":"', 15), '{"ky":"SeatCushionWashable", "vl":"'), ifnull(SeatCushionWashable, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"BabyInsert", "vl":"', 15), '{"ky":"BabyInsert", "vl":"'), ifnull(BabyInsert, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"BabyInsertMaterial", "vl":"', 15), '{"ky":"BabyInsertMaterial", "vl":"'), ifnull(BabyInsertMaterial, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"Footplate", "vl":"', 15), '{"ky":"Footplate", "vl":"'), ifnull(Footplate, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"FoodTrayFeatures", "vl":"', 15), '{"ky":"FoodTrayFeatures", "vl":"'), ifnull(FoodTrayFeatures, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"FoodTrayMaintenance", "vl":"', 15), '{"ky":"FoodTrayMaintenance", "vl":"'), ifnull(FoodTrayMaintenance, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"TrayMaterial", "vl":"', 15), '{"ky":"TrayMaterial", "vl":"'), ifnull(TrayMaterial, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"FrameMaterial", "vl":"', 15), '{"ky":"FrameMaterial", "vl":"'), ifnull(FrameMaterial, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"WoodType", "vl":"', 15), '{"ky":"WoodType", "vl":"'), ifnull(WoodType, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"WoodFinish", "vl":"', 15), '{"ky":"WoodFinish", "vl":"'), ifnull(WoodFinish, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"Multifunctional", "vl":"', 15), '{"ky":"Multifunctional", "vl":"'), ifnull(Multifunctional, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"AdditionalFeatures", "vl":"', 15), '{"ky":"AdditionalFeatures", "vl":"'), ifnull(AdditionalFeatures, 'null'), '"},',
       if(v.SeatCushion IS NOT NULL, concat(getProductDetailGroupsAccessories(15, '{"ky":"SeatCushion", "vl":"', SeatCushion), v.SeatCushion, '"},'), ''),
       if(v.BabyInsert IS NOT NULL, concat(getProductDetailGroupsAccessories(15, '{"ky":"BabyInsert", "vl":"', BabyInsert), v.BabyInsert, '"},'), ''),
       ifnull(getProductDetailGroups('{"ky":"ListPrice", "vl":"', 15), '{"ky":"ListPrice", "vl":"'), ifnull(ListPrice, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"ListPriceRange", "vl":"', 15), '{"ky":"ListPriceRange", "vl":"'), ifnull(ListPriceRange, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"SalePrice", "vl":"', 15), '{"ky":"SalePrice", "vl":"'), ifnull(SalePrice, 'null'), '"},',
       getLowestPriceInfo(15, v.HighChair_ID), ',',
       ifnull(getProductDetailGroups('{"ky":"NewModelDiscount", "vl":"', 15), '{"ky":"NewModelDiscount", "vl":"'), ifnull(NewModelDiscount, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"DiscountedModelURL", "vl":"', 15), '{"ky":"DiscountedModelURL", "vl":"'), ifnull(SourceURLDiscountedModel, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"FacebookURL", "vl":"', 15), '{"ky":"FacebookURL", "vl":"'), ifnull(FacebookURL, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"BrandFacebookLikes", "vl":"', 15), '{"ky":"BrandFacebookLikes", "vl":"'), ifnull(BrandFacebookLikes, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"TwitterName", "vl":"', 15), '{"ky":"TwitterName", "vl":"'), ifnull(TwitterName, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"TwitterURL", "vl":"', 15), '{"ky":"TwitterURL", "vl":"'), ifnull(TwitterURL, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"BrandTwitterFollowers", "vl":"', 15), '{"ky":"BrandTwitterFollowers", "vl":"'), ifnull(BrandTwitterFollowers, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"YoutubeURL", "vl":"', 15), '{"ky":"YoutubeURL", "vl":"'), ifnull(YoutubeChannelURL, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"YoutubeSubscribers", "vl":"', 15), '{"ky":"YoutubeSubscribers", "vl":"'), ifnull(YoutubeChannelSubscribers, 'null'), '"},',
       ifnull(getProductDetailGroups('{"ky":"YoutubeViews", "vl":"', 15), '{"ky":"YoutubeViews", "vl":"'), ifnull(YoutubeChannelViews, 'null'), '"}],',
       '"mtvtrs" : {',
       '"A":', ifnull(m.A, 0), ',',
       '"B":', ifnull(m.B, 0), ',',
       '"C":', ifnull(m.C, 0), ',',
       '"E":', ifnull(m.E, 0), ',',
       '"F":', ifnull(m.F, 0), ',',
       '"G":', ifnull(m.G, 0), ',',
       '"H":', ifnull(m.H, 0), ',',
       '"I":', ifnull(m.I, 0), ',',
       '"J":', ifnull(m.J, 0), ',',
       '"K":', ifnull(m.K, 0), ',',
       '"L":', ifnull(m.L, 0), '',
       '}}'), '"null"', 'null')) AS payload
FROM
  vw_highchair_data_ui v
JOIN vw_highchair_motivators m
ON v.HighChair_ID = m.ItemID AND
m.CategoryID = v.CategoryID
WHERE
  getDefaultProductImage(15, v.HighChair_ID) IS NOT NULL
  AND getLowestPriceInfo(15, v.HighChair_ID) IS NOT NULL
  AND (v.IsDirty = 1 or imagesDirty(15,v.HighChair_ID))
GROUP BY v.HighChair_ID
                ]]>
            </value>
        </property>
        <property name="ingestService" ref="itemService"/>
        <property name="ingestMethod" value="saveItems"/>
        <property name="jsonType" value="com.lela.domain.document.Item"/>
        <property name="batchSize" value="10"/>
        <property name="etlUpdateQuery">
            <value>
                <![CDATA[
                update highchair_data set objectId = '@{id}', isdirty = -1 where highchair_id = @{tld}
                ]]>
            </value>
        </property>
    </bean>
    -->
    <!--Affiliate Reporting Ingest Job-->
    <bean id="affiliateReportingUserSalesEtlJobDetail" class="com.lela.commons.jobs.etl.EtlJobDetail">
        <property name="name" value="Ingest Affiliate Reporting User Sales"/>
        <property name="sqlQuery">
            <value>
                <![CDATA[
                CALL IngestSales
                ]]>
            </value>
        </property>
        <property name="ingestService" ref="userTrackerService"/>
        <property name="ingestMethod" value="trackRedirectSale"/>
        <property name="jsonType" value="com.lela.domain.dto.AffiliateTransaction"/>
        <property name="batchSize" value="10"/>
        <property name="etlUpdateQuery">
            <value>
                <![CDATA[
                update affiliate_transaction set SyncdMongo = 1 where affiliateTransactionId = '@{id}'
                ]]>
            </value>
        </property>
    </bean>

    <!--Affiliate Reporting Ingest Job-->
    <bean id="affiliateReportingAnonymousSalesEtlJobDetail" class="com.lela.commons.jobs.etl.EtlJobDetail">
        <property name="name" value="Ingest Affiliate Reporting Anonymous Sales"/>
        <property name="sqlQuery">
            <value>
                <![CDATA[
                CALL IngestAnonymousSales
                ]]>
            </value>
        </property>
        <property name="ingestService" ref="userTrackerService"/>
        <property name="ingestMethod" value="trackAnonymousSale"/>
        <property name="jsonType" value="com.lela.domain.dto.AffiliateTransaction"/>
        <property name="batchSize" value="10"/>
        <property name="etlUpdateQuery">
            <value>
                <![CDATA[
                update affiliate_transaction set SyncdMongo = 1 where affiliateTransactionId = '@{id}'
                ]]>
            </value>
        </property>
    </bean>

    <!-- interceptors -->
    <bean id="functionalFiltersIngestJobInterceptor"
          class="com.lela.commons.jobs.interceptor.FunctionalFiltersIngestJobInterceptor"
          c:functionalFilterService-ref="functionalFilterService"
          c:itemService-ref="itemService"
          c:categoryService-ref="categoryService"/>

    <bean id="allFunctionalFiltersIngestJobInterceptor"
          class="com.lela.commons.jobs.interceptor.AllFunctionalFiltersIngestJobInterceptor"
          c:functionalFilterService-ref="functionalFilterService"
          c:itemService-ref="itemService"
          c:categoryService-ref="categoryService"/>
</beans>




